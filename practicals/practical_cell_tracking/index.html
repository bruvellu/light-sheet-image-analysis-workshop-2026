<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bruno C. Vellutini">
<meta name="dcterms.date" content="2026-01-05">

<title>Cell tracking using Mastodon in Fiji ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../practicals/practical_2d_visualization.html" rel="next">
<link href="../../internal/quarto.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-635a35c16803d16fd9db22f392043487.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Cell tracking using Mastodon in Fiji ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:description" content="">
<meta property="og:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_cell_tracking/media/01-dataset-zip.png">
<meta property="og:site_name" content="üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:image:alt" content="Your working directory after downloading and unzipping the dataset file.">
<meta property="og:image:height" content="882">
<meta property="og:image:width" content="994">
<meta name="twitter:title" content="Cell tracking using Mastodon in Fiji ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_cell_tracking/media/01-dataset-zip.png">
<meta name="twitter:image:alt" content="Your working directory after downloading and unzipping the dataset file.">
<meta name="twitter:image-height" content="882">
<meta name="twitter:image-width" content="994">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">üî¨ Light-Sheet Image Analysis Workshop 2026</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_cell_tracking/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_cell_tracking/index.html">Cell tracking using Mastodon in Fiji</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Help</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Program</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Internal</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/draft_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Original draft program</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example presentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto reference guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Practicals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_cell_tracking/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Cell tracking using Mastodon in Fiji</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_2d_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 2D images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_3d_segmentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3D segmentation using machine/deep learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_3d_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 3D images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_image_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post-processing, segmentation and labelling in Fiji (2D)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_imagej_macros.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ImageJ macros</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_multiview_reconstruction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_tissue_cartography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tissue cartography</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Images</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/images/readme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Readme</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Talks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_data_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best practices in microscopy data management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_deep_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_digital_images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization and processing of digital images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_experimental_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental design and sample mounting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_image_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image processing and analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_lightsheet_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concepts in light-sheet microscopy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_multiview_cartography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction and tissue cartography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Talk Welcome</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-summary" id="toc-sec-summary" class="nav-link active" data-scroll-target="#sec-summary">Summary</a></li>
  <li><a href="#sec-requirements" id="toc-sec-requirements" class="nav-link" data-scroll-target="#sec-requirements">Requirements</a></li>
  <li><a href="#sec-setup" id="toc-sec-setup" class="nav-link" data-scroll-target="#sec-setup">Setup</a>
  <ul class="collapse">
  <li><a href="#sec-setup-dataset" id="toc-sec-setup-dataset" class="nav-link" data-scroll-target="#sec-setup-dataset">Download Dataset</a></li>
  <li><a href="#sec-setup-fiji" id="toc-sec-setup-fiji" class="nav-link" data-scroll-target="#sec-setup-fiji">Download Fiji</a></li>
  <li><a href="#sec-setup-mastodon" id="toc-sec-setup-mastodon" class="nav-link" data-scroll-target="#sec-setup-mastodon">Install Mastodon</a></li>
  </ul></li>
  <li><a href="#sec-open-project" id="toc-sec-open-project" class="nav-link" data-scroll-target="#sec-open-project">Open Mastodon Project</a></li>
  <li><a href="#sec-inspect-dataset" id="toc-sec-inspect-dataset" class="nav-link" data-scroll-target="#sec-inspect-dataset">Inspect the Dataset</a></li>
  <li><a href="#sec-manual-tracking" id="toc-sec-manual-tracking" class="nav-link" data-scroll-target="#sec-manual-tracking">Manual Tracking</a></li>
  <li><a href="#sec-semiauto-tracking" id="toc-sec-semiauto-tracking" class="nav-link" data-scroll-target="#sec-semiauto-tracking">Semi-Automated Tracking</a></li>
  <li><a href="#sec-auto-tracking" id="toc-sec-auto-tracking" class="nav-link" data-scroll-target="#sec-auto-tracking">Automatic Detection and Linking</a></li>
  <li><a href="#sec-feature-visualization" id="toc-sec-feature-visualization" class="nav-link" data-scroll-target="#sec-feature-visualization">Basic Feature Visualization</a></li>
  <li><a href="#sec-graph-plotting" id="toc-sec-graph-plotting" class="nav-link" data-scroll-target="#sec-graph-plotting">Graph Plotting</a></li>
  <li><a href="#sec-references" id="toc-sec-references" class="nav-link" data-scroll-target="#sec-references">References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_cell_tracking/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_cell_tracking/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_cell_tracking/index.html">Cell tracking using Mastodon in Fiji</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Cell tracking using Mastodon in Fiji</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bruno C. Vellutini </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 5, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="sec-summary" class="level2">
<h2 class="anchored" data-anchor-id="sec-summary">Summary</h2>
<p>This is a (very) basic tutorial on how to track cells using Mastodon <span class="citation" data-cites="Girstmair2025-qd">(<a href="#ref-Girstmair2025-qd" role="doc-biblioref">Girstmair et al. 2025</a>)</span> in Fiji <span class="citation" data-cites="Schindelin2012-di">(<a href="#ref-Schindelin2012-di" role="doc-biblioref">Schindelin et al. 2012</a>)</span>.</p>
<ul>
<li>Objectives: load/create Mastodon dataset, get familiar with navigating BigDataViewer and lineage windows, perform basic manual cell tracking with cell divisions, basic editing of lineages, try semi-automated detection and tracking, and some advanced analysis</li>
<li>We will use the Mastodon dataset from Girstmair, J. (2024). Mastodon Auto-Tracking Demo on Parhyale hawaiensis Limb Development. Zenodo. https://doi.org/10.5281/zenodo.13944688</li>
<li>The original data is from this paper https://elifesciences.org/articles/34410</li>
<li>Mastodon has a detailed documentation. Please check it out for more details https://mastodon.readthedocs.io/</li>
</ul>
</section>
<section id="sec-requirements" class="level2">
<h2 class="anchored" data-anchor-id="sec-requirements">Requirements</h2>
<ul>
<li>Parhyale dataset</li>
<li>Fiji/ImageJ</li>
<li>Mastodon</li>
</ul>
</section>
<section id="sec-setup" class="level2">
<h2 class="anchored" data-anchor-id="sec-setup">Setup</h2>
<section id="sec-setup-dataset" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-dataset">Download Dataset</h3>
<p>Note! If you are following this during the course, the dataset has already been downloaded.</p>
<ul>
<li>Go to https://zenodo.org/records/13944688</li>
<li>Click to download https://zenodo.org/records/13944688/files/Mastodon_Auto-Tracking_Demo_Ph-limb-dev.zip?download=1</li>
<li>Wait. It‚Äôs a 4.3GB ZIP file</li>
<li>Move the file to a working directory</li>
<li>Unzip <code>Mastodon_Auto-Tracking_Demo_Ph-limb-dev.zip</code></li>
<li>Wait. It‚Äôll be unzipped to 23GB</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/01-dataset-zip.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Your working directory after downloading and unzipping the dataset file."><img src="media/01-dataset-zip.png" class="img-fluid figure-img" alt="Your working directory after downloading and unzipping the dataset file."></a></p>
<figcaption>Your working directory after downloading and unzipping the dataset file.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="media/02-dataset-dir.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Contents of the dataset directory."><img src="media/02-dataset-dir.png" class="img-fluid figure-img" alt="Contents of the dataset directory."></a></p>
<figcaption>Contents of the dataset directory.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="sec-setup-fiji" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-fiji">Download Fiji</h3>
<ul>
<li>Go to https://fiji.sc</li>
<li>Choose <code>Distribution: Stable</code></li>
<li>Click the big download button</li>
<li>Copy <code>fiji-stable-linux64-jdk.zip</code> to working directory and unzip it</li>
<li>Open the new directory <code>fiji-stable-linux64-jdk/Fiji.app/</code></li>
<li>Double-click on <code>fiji-linux-x64</code> launcher</li>
<li>Fiji will open</li>
</ul>
<p><a href="media/03-fiji-dir.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="media/03-fiji-dir.png" class="img-fluid"></a></p>
</section>
<section id="sec-setup-mastodon" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-mastodon">Install Mastodon</h3>
<ul>
<li>Click on <code>Help &gt; Update...</code></li>
</ul>
<p><a href="media/04-fiji-update.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="media/04-fiji-update.png" class="img-fluid"></a></p>
<ul>
<li>The updater will open and say Fiji is up-to-date</li>
<li>Click <code>Manage Update Sites</code></li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/05-fiji-up-to-date.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="media/05-fiji-up-to-date.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/06-fiji-manage.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="media/06-fiji-manage.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>A window will open with a list of plugins available to install in Fiji</li>
</ul>
<p><a href="media/07-fiji-plugins.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="media/07-fiji-plugins.png" class="img-fluid"></a></p>
<ul>
<li>Search for ‚Äúmastodon‚Äù</li>
</ul>
<p><a href="media/08-fiji-search.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="media/08-fiji-search.png" class="img-fluid"></a></p>
<ul>
<li>Several Mastodon related plugins will appear</li>
<li>Click on the checkbox for <code>Mastodon</code></li>
</ul>
<p><a href="media/09-fiji-mastodon.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="media/09-fiji-mastodon.png" class="img-fluid"></a></p>
<ul>
<li>Click <code>Apply and Close</code> and then <code>Apply Changes</code></li>
</ul>
<p><a href="media/10-fiji-apply.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="media/10-fiji-apply.png" class="img-fluid"></a></p>
<ul>
<li>Wait‚Ä¶ until the downloads are finished. Then, click <code>OK</code></li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/11-fiji-download.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="media/11-fiji-download.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/12-fiji-restart.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="media/12-fiji-restart.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>Restart Fiji (close window and double-click the launcher)</li>
</ul>
</section>
</section>
<section id="sec-open-project" class="level2">
<h2 class="anchored" data-anchor-id="sec-open-project">Open Mastodon Project</h2>
<ul>
<li>In Fiji click on <code>Plugins &gt; Tracking &gt; Mastodon &gt; Mastodon Launcher</code></li>
<li>Mastodon Launcher window will open</li>
<li>Click on ‚Äúopen Mastodon project‚Äù (top left) and ‚ÄúOpen another project‚Äù (bottom right)</li>
<li>Navigate to the directory <code>Mastodon_Auto-Tracking_Demo_Ph-limb-dev/</code></li>
<li>Select the file <code>Parhyale_LimbDev_30tps.mastodon</code></li>
<li>Several new windows will open (Console, Mastodon, BigDataViewer, TrackScheme, Data table)</li>
</ul>
</section>
<section id="sec-inspect-dataset" class="level2">
<h2 class="anchored" data-anchor-id="sec-inspect-dataset">Inspect the Dataset</h2>
<ul>
<li>Let‚Äôs focus on the Mastodon window. Close Console, BigDataViewer, TrackScheme, Data table</li>
<li>This is the main project menu from where you can open windows, set options, process data and save the project</li>
<li>The most important buttons for this tutorial are <code>bdv</code> (BigDataViewer) and <code>trackscheme</code></li>
<li>Click on <code>bdv</code> and make the window larger</li>
<li>Drag the timepoint slider at the bottom to see cells moving and dividing</li>
<li>Using your acquired BigDataViewer skills, focus on the surface of the embryo</li>
<li>If you get lost, press <code>Shift+Z</code> to re-orient the embryo</li>
<li>Find a cell that divides before timepoint 15 and looks trackable</li>
<li>Zoom on it using <code>Ctrl+Shift+scroll</code> and center it by holding the right button and dragging the mouse</li>
<li>Use <code>Shift+scroll</code> to navigate through z and <code>M-N</code> to go through time</li>
<li>You are ready to track</li>
</ul>
</section>
<section id="sec-manual-tracking" class="level2">
<h2 class="anchored" data-anchor-id="sec-manual-tracking">Manual Tracking</h2>
<ul>
<li>On the Mastodon project window, click on the <code>trackscheme</code> button</li>
<li>The TrackScheme window will appear</li>
<li>Resize the bdv window to be side-by-side with the TrackScheme</li>
<li>Click on the bdv window, set the timepoint to some frames before mitosis, <code>Shift+scroll</code> to find the center of the nucleus, put your mouse pointer there and press <code>A</code></li>
<li>A round magenta circle will appear over the nucleus and in the TrackScheme</li>
<li>With your mouse over the circle, use <code>Shift+Q</code> and <code>Shift+E</code> to adjust the size of the spot to roughly the nucleus diameter</li>
<li>Zoom in on the new spot in the TrackScheme, hover and click on it and watch what happens in the bdv window</li>
<li>Go back to the bdv, hover the pointer over the circle and hold the spacebar to adjust the position of the circle and the nucleus</li>
<li>Now let‚Äôs add a second spot</li>
<li>Hover the mouse inside the circle and hold <code>A</code>. This will advance to the next frame showing you the first spot in white dashed line and the second spot in white solid line with a white solid link between the two. Still holding <code>A</code>, position the second spot, then release <code>A</code> to create the new linked spot</li>
<li>Check how the second spot and a link were created in the TrackScheme automatically</li>
<li>Continue to track the nucleus for a few more frames, until the frame immediately before division</li>
<li>Note that when you click on a spot in the bdv window, the corresponding spot is highlighted in the TrackScheme window</li>
<li>See what happens to the bdv when clicking the spots in TrackScheme‚Ä¶ (nothing, unless it is the spot in view)</li>
<li>Let‚Äôs change that</li>
<li>In the menu bar of bdv and TrackScheme windows there are locks 1, 2, 3. Click on lock 1 in both windows</li>
<li>Now click through spots in the TrackScheme; the view in the bdv will change to show the selected spot at the center</li>
<li>Before we continue tracking the cell division, let‚Äôs check one of the amazing Mastodon features</li>
<li>Click on the <code>bdv</code> button in the Mastodon project window and another bdv window will open</li>
<li>Now activate lock 1 and click on one of the TrackScheme spots; both windows will be synchronized!</li>
<li>Why is this useful for manual tracking? Adjust the view to center the spot in the second bdv window, press <code>Shift+Y</code>, and select a spot from the TrackScheme. Now we have both XY and ZY views of the same nucleus! Which is great for tracking in 3D. You can check, for instance, that your spot is well centered in Z and adjust it in this window</li>
<li>OK. Continue the tracking of one of the daughter cells. Select the last spot in the TrackScheme, go to the XY bdv, hover the mouse over the circle and hold <code>A</code>, move the spot, and release <code>A</code> to add it. Do it for a few frames</li>
<li>Then go back to the pre-division spot and do the same for the other daughter cell</li>
<li>This will create the first branch of the lineage tree (adjust the TrackScheme view to see it)</li>
</ul>
</section>
<section id="sec-semiauto-tracking" class="level2">
<h2 class="anchored" data-anchor-id="sec-semiauto-tracking">Semi-Automated Tracking</h2>
<ul>
<li>This mode will try to guess where the next nucleus is and automatically create the spots and links</li>
<li>It requires you to set one spot, so let‚Äôs pick a different nucleus. Choose a bright one you like</li>
<li>Now, hovering above the circle press <code>Ctrl+T</code></li>
<li>A lineage will appear in the TrackScheme. Check how accurate it is by clicking on the spots and watching their position relative to the nucleus in the bdv windows</li>
<li>Try going further by hovering on a spot and pressing <code>Ctrl+T</code> to continue the semi-automated tracking. See how long you can go, how it behaves with cell divisions, and which cells work well with it and which don‚Äôt</li>
<li>There are many parameters that can be adjusted to tweak the semi-automated tracking behavior, check the documentation</li>
</ul>
</section>
<section id="sec-auto-tracking" class="level2">
<h2 class="anchored" data-anchor-id="sec-auto-tracking">Automatic Detection and Linking</h2>
<ul>
<li>The final part of this tutorial is to try automatic detection and linking of spots</li>
<li>This is the dream: loading your data and getting out your lineage. However, in practice, it‚Äôs a lot messier. Cleaning, fixing, and curating the data is required to get a nice informative lineage</li>
<li>We will use a simplified version of the protocol included in this dataset in the file <code>Protocol_Auto-Detection_Auto-Linking.docx</code></li>
<li>In the Mastodon window, go to <code>Plugins &gt; Tracking &gt; Detection...</code></li>
<li>Press <code>Next</code> twice (leave options as is)</li>
<li>Choose <code>Advanced DoG detector</code> and press <code>Next</code></li>
<li>Keep <code>Detect: bright blobs</code>, change <code>Estimated diameter</code> to <code>35px</code> and <code>Quality threshold</code> to <code>100</code>. <code>Behavior</code> should remain as <code>Add</code></li>
<li>Click <code>Preview</code> and see how well the detection will work by exploring a new bdv window. Do you observe too many false positives? You can change the diameter, for example, and try the preview again to see what happens to the detected spots</li>
<li>Once satisfied, press <code>Next</code> and wait</li>
<li>When the detection is done, press <code>Finish</code></li>
<li>The bdv windows and the TrackScheme will be showing all the spots. Explore a bit the bdv and TrackScheme. If you zoom in a lot you‚Äôll see the unlinked, individual spots per frame</li>
<li>Before we try to automatically link these spots, let‚Äôs remove low quality detections</li>
<li>On the Mastodon window click on <code>Table</code>, resize it to have more space, and resize the column <code>Detection q...</code> to show <code>Detection quality</code></li>
<li>Click on <code>Detection quality</code> to sort the table</li>
<li>Click on the first row to select it. Select all rows where <code>Detection quality</code> is &lt;400</li>
<li>Then click <code>Edit &gt; Delete Selection</code></li>
<li>Close the table</li>
<li>You can also manually delete obviously wrong spots by hovering and pressing <code>D</code>. Clean up the ones outside the embryo</li>
<li>Now let‚Äôs try linking</li>
<li>In the main Mastodon window click on <code>Plugins &gt; Tracking &gt; Linking...</code></li>
<li>Keep <code>All spots</code> selected for all timepoints (0-29) and press <code>Next</code></li>
<li>Choose <code>Lap linker</code> and click <code>Next</code></li>
<li>Change the parameters to:
<ul>
<li><code>Frame to frame linking</code>: <code>Max distance</code> to <code>40px</code></li>
<li><code>Gap closing</code>: <code>Max distance</code> to <code>60px</code> (keep others as is)</li>
<li><code>Track division</code>: Check <code>Allow track division</code>, set <code>Max distance</code> to <code>40px</code>, and press <code>+</code> to add a <code>Feature penalty</code> and set it to <code>Center ch1</code> to <code>0.3</code></li>
</ul></li>
<li>Press <code>Next</code> to start linking and wait‚Ä¶ then press <code>Finish</code></li>
<li>Note that there are now tracks in the bdv and TrackScheme windows. Explore them a bit</li>
<li>Mastodon can calculate features (position, displacement, velocity, etc.) of individual spots, links and branches. Let‚Äôs do that</li>
<li>In the main Mastodon window press <code>compute features</code>. A Feature calculation window will open</li>
<li>Press <code>compute</code> and wait‚Ä¶ when it‚Äôs done, close it</li>
</ul>
</section>
<section id="sec-feature-visualization" class="level2">
<h2 class="anchored" data-anchor-id="sec-feature-visualization">Basic Feature Visualization</h2>
<ul>
<li>Finally, let‚Äôs visualize the computed features that might be interesting or useful</li>
<li>In the bdv window press <code>File &gt; Preferences</code> to open the feature color coding visualization parameters</li>
<li>On <code>Settings &gt; Feature Color Modes</code> click on <code>Duplicate</code> (it‚Äôll generate a <code>Number of links (2)</code>) and then <code>Rename</code>. Rename it to <code>Velocity</code></li>
<li>On the <code>Coloring Spots</code> change <code>Read spot color from</code> to <code>Incoming link</code> and change <code>Feature</code> to <code>Link velocity</code>. Then click on <code>autoscale</code> in the range</li>
<li>On the <code>Coloring Links</code> change <code>Read link color from</code> to <code>Link</code> and change <code>Feature</code> to <code>Link velocity</code>. Then also click on <code>autoscale</code></li>
<li>Click <code>Apply</code> (nothing will happen) then <code>OK</code></li>
<li>On the bdv window press <code>View &gt; Coloring &gt; Velocity</code></li>
<li>Do the same for the other bdv window and the TrackScheme</li>
<li>This gives a visual representation of cells which have a high displacement per frame. These might be artifacts in linking unrelated spots or, in a good processed lineage, reveal some biological process like cell migration</li>
</ul>
</section>
<section id="sec-graph-plotting" class="level2">
<h2 class="anchored" data-anchor-id="sec-graph-plotting">Graph Plotting</h2>
<ul>
<li>To finalize, a simple example of plotting</li>
<li>Click on <code>grapher</code> in the main Mastodon window, a plot window will open</li>
<li>Press the lock 1 to lock the windows, select <code>Link velocity - outgoing</code> for X axis and <code>Detection quality</code> for Y axis and press <code>Plot</code></li>
<li>Find out if the spots with the highest link velocity are properly linked or if it is an artifact</li>
</ul>
</section>
<section id="sec-references" class="level2">
<h2 class="anchored" data-anchor-id="sec-references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Girstmair2025-qd" class="csl-entry" role="listitem">
Girstmair, Johannes, Tobias Pietzsch, Vladimir Ulman, Stefan Hahmann, Matthias Arzt, Mette Handberg-Thorsager, Ko Sugawara, et al. 2025. <span>‚ÄúMastodon: The Command Center for Large-Scale Lineage-Tracing Microscopy Datasets.‚Äù</span> <em>bioRxiv</em>, December, 2025.12.10.693416. <a href="https://doi.org/10.64898/2025.12.10.693416">https://doi.org/10.64898/2025.12.10.693416</a>.
</div>
<div id="ref-Schindelin2012-di" class="csl-entry" role="listitem">
Schindelin, Johannes, Ignacio Arganda-Carreras, Erwin Frise, Verena Kaynig, Mark Longair, Tobias Pietzsch, Stephan Preibisch, et al. 2012. <span>‚ÄúFiji: An Open-Source Platform for Biological-Image Analysis.‚Äù</span> <em>Nat. Methods</em> 9 (June): 676‚Äì82. <a href="https://doi.org/10.1038/nmeth.2019">https://doi.org/10.1038/nmeth.2019</a>.
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bruvellu\.github\.io\/light-sheet-image-analysis-workshop-2026");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../internal/quarto.html" class="pagination-link" aria-label="Quarto reference guide">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Quarto reference guide</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../practicals/practical_2d_visualization.html" class="pagination-link" aria-label="Visualization of 2D images">
        <span class="nav-page-text">Visualization of 2D images</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://lightsheetchile.cl/light-sheet-image-analysis-workshop-2026-2/">
<p>LiSIUM</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_cell_tracking/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>