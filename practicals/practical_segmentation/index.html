<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marina Cuenca">
<meta name="dcterms.date" content="2026-01-05">

<title>Post-processing, segmentation and labelling ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../practicals/practical_cartography/index.html" rel="next">
<link href="../../practicals/practical_3d/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-635a35c16803d16fd9db22f392043487.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Post-processing, segmentation and labelling ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:description" content="">
<meta property="og:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_segmentation/images/MAX_Lund.png">
<meta property="og:site_name" content="üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:image:alt" content="Brightness/Contrast histogram">
<meta property="og:image:height" content="256">
<meta property="og:image:width" content="256">
<meta name="twitter:title" content="Post-processing, segmentation and labelling ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_segmentation/images/MAX_Lund.png">
<meta name="twitter:image:alt" content="Brightness/Contrast histogram">
<meta name="twitter:image-height" content="256">
<meta name="twitter:image-width" content="256">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">üî¨ Light-Sheet Image Analysis Workshop 2026</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_multiview/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_segmentation/index.html">Post-processing, segmentation and labelling</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Help</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Program</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Internal</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/draft_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Original draft program</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example presentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../internal/quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto reference guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Practicals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_multiview/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_macros/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ImageJ macros</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_tracking/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cell tracking using Mastodon in Fiji</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_3d/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 3D images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_segmentation/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Post-processing, segmentation and labelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_cartography/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tissue cartography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_2d/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 2D images</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Practical Deep Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_deep_learning/object-classification/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Object-classification, dimensionality reduction and clustering</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Talks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_data_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best practices in microscopy data management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_deep_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_digital_images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization and processing of digital images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_experimental_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental design and sample mounting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_image_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image processing and analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_lightsheet_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concepts in light-sheet microscopy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_multiview_cartography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction and tissue cartography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Talk Welcome</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#d-segmentation-in-fiji" id="toc-d-segmentation-in-fiji" class="nav-link active" data-scroll-target="#d-segmentation-in-fiji">2D segmentation in Fiji</a>
  <ul>
  <li><a href="#open-the-image-and-inspect-the-histogram" id="toc-open-the-image-and-inspect-the-histogram" class="nav-link" data-scroll-target="#open-the-image-and-inspect-the-histogram">1. Open the image and inspect the histogram</a></li>
  <li><a href="#try-all-global-auto-threshold-methods" id="toc-try-all-global-auto-threshold-methods" class="nav-link" data-scroll-target="#try-all-global-auto-threshold-methods">2. Try all global Auto Threshold methods</a></li>
  <li><a href="#prepare-the-image-for-auto-local-threshold" id="toc-prepare-the-image-for-auto-local-threshold" class="nav-link" data-scroll-target="#prepare-the-image-for-auto-local-threshold">3. Prepare the image for Auto Local Threshold</a></li>
  <li><a href="#try-all-auto-local-threshold-methods" id="toc-try-all-auto-local-threshold-methods" class="nav-link" data-scroll-target="#try-all-auto-local-threshold-methods">4. Try all Auto Local Threshold methods</a></li>
  <li><a href="#improving-segmentation-with-background-subtraction-and-smoothing" id="toc-improving-segmentation-with-background-subtraction-and-smoothing" class="nav-link" data-scroll-target="#improving-segmentation-with-background-subtraction-and-smoothing">5. Improving segmentation with background subtraction and smoothing</a>
  <ul class="collapse">
  <li><a href="#remove-background-and-apply-gaussian-blur" id="toc-remove-background-and-apply-gaussian-blur" class="nav-link" data-scroll-target="#remove-background-and-apply-gaussian-blur">5.1 Remove background and apply Gaussian blur</a></li>
  </ul></li>
  <li><a href="#selecting-a-method-local-otsu-and-binary-cleanup" id="toc-selecting-a-method-local-otsu-and-binary-cleanup" class="nav-link" data-scroll-target="#selecting-a-method-local-otsu-and-binary-cleanup">6. Selecting a method: Local Otsu and binary cleanup</a>
  <ul class="collapse">
  <li><a href="#apply-local-otsu-thresholding" id="toc-apply-local-otsu-thresholding" class="nav-link" data-scroll-target="#apply-local-otsu-thresholding">6.1 Apply Local Otsu thresholding</a></li>
  <li><a href="#refine-the-mask-with-binary-operations" id="toc-refine-the-mask-with-binary-operations" class="nav-link" data-scroll-target="#refine-the-mask-with-binary-operations">6.2 Refine the mask with binary operations</a></li>
  <li><a href="#remove-border-touching-objects" id="toc-remove-border-touching-objects" class="nav-link" data-scroll-target="#remove-border-touching-objects">6.3 Remove border-touching objects</a></li>
  </ul></li>
  <li><a href="#object-labeling-with-morpholibj" id="toc-object-labeling-with-morpholibj" class="nav-link" data-scroll-target="#object-labeling-with-morpholibj">7. Object labeling with MorphoLibJ</a></li>
  <li><a href="#measuring-object-properties" id="toc-measuring-object-properties" class="nav-link" data-scroll-target="#measuring-object-properties">8. Measuring object properties</a></li>
  <li><a href="#visualizing-label-properties" id="toc-visualizing-label-properties" class="nav-link" data-scroll-target="#visualizing-label-properties">9. Visualizing label properties</a></li>
  <li><a href="#filtering-objects-by-size" id="toc-filtering-objects-by-size" class="nav-link" data-scroll-target="#filtering-objects-by-size">10. Filtering objects by size</a></li>
  </ul></li>
  <li><a href="#d-segmentation-in-napari" id="toc-d-segmentation-in-napari" class="nav-link" data-scroll-target="#d-segmentation-in-napari">3D segmentation in Napari</a>
  <ul>
  <li><a href="#open-napari-assistant-using-pixi" id="toc-open-napari-assistant-using-pixi" class="nav-link" data-scroll-target="#open-napari-assistant-using-pixi">0. Open Napari assistant using Pixi</a></li>
  <li><a href="#open-a-3d-stack" id="toc-open-a-3d-stack" class="nav-link" data-scroll-target="#open-a-3d-stack">1. Open a 3D stack</a></li>
  <li><a href="#remove-background-binarization-and-labeling" id="toc-remove-background-binarization-and-labeling" class="nav-link" data-scroll-target="#remove-background-binarization-and-labeling">2. Remove background, binarization and labeling</a></li>
  <li><a href="#fix-labels" id="toc-fix-labels" class="nav-link" data-scroll-target="#fix-labels">3. Fix labels</a></li>
  <li><a href="#measure-morphological-properties" id="toc-measure-morphological-properties" class="nav-link" data-scroll-target="#measure-morphological-properties">4. Measure morphological properties</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_segmentation/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_multiview/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_segmentation/index.html">Post-processing, segmentation and labelling</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Post-processing, segmentation and labelling</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marina Cuenca </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 5, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="d-segmentation-in-fiji" class="level2">
<h2 class="anchored" data-anchor-id="d-segmentation-in-fiji">2D segmentation in Fiji</h2>
<p>In this exercise we will:</p>
<ul>
<li>Compare global and local thresholding methods and understand when each is useful.<br>
</li>
<li>Improve segmentation using background subtraction and Gaussian smoothing.<br>
</li>
<li>Refine masks using binary operations, including <strong>Fill Holes</strong> and <strong>Kill Borders</strong>.<br>
</li>
<li>Generate labeled objects using MorphoLibJ‚Äôs Connected Components Labeling.<br>
</li>
<li>Extract object-level measurements (area, perimeter, circularity, etc.).<br>
</li>
<li>Visualize measurement values on labeled images.<br>
</li>
<li>Filter segmented objects based on size or other properties.</li>
</ul>
<p>These steps form a complete workflow: <strong>raw image ‚Üí pre-processing ‚Üí segmentation ‚Üí cleanup ‚Üí labeling ‚Üí measurement ‚Üí filtering</strong></p>
<p>We‚Äôll use <code>MAX_Lund.tif</code> as the example image https://zenodo.org/records/17986091</p>
<p>Requirements: - Fiji - MorphoLibJ plugin https://imagej.net/plugins/morpholibj</p>
<section id="open-the-image-and-inspect-the-histogram" class="level3">
<h3 class="anchored" data-anchor-id="open-the-image-and-inspect-the-histogram">1. Open the image and inspect the histogram</h3>
<ol type="1">
<li>Start <strong>Fiji</strong>.<br>
</li>
<li>Open the image:<br>
<code>File ‚Üí Open‚Ä¶ ‚Üí MAX_Lund.tif</code><br>
<img src="images/MAX_Lund.png" class="img-fluid" alt="Brightness/Contrast histogram"></li>
<li>Open the histogram and visualization tools:<br>
<code>Image ‚Üí Adjust ‚Üí Brightness/Contrast‚Ä¶</code></li>
</ol>
<p>You should see a histogram like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Screenshot1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Brightness/Contrast histogram"><img src="images/Screenshot1.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p><strong>Idea:</strong> Thresholding chooses an intensity value that separates ‚Äúforeground‚Äù from ‚Äúbackground‚Äù. The histogram shows how many pixels exist at each intensity.</p>
</section>
<section id="try-all-global-auto-threshold-methods" class="level3">
<h3 class="anchored" data-anchor-id="try-all-global-auto-threshold-methods">2. Try all global Auto Threshold methods</h3>
<p>Global thresholding applies <strong>one single threshold</strong> to the whole image.</p>
<ol type="1">
<li>With <code>MAX_Lund.tif</code> active, run:<br>
<code>Image ‚Üí Adjust ‚Üí Auto Threshold‚Ä¶</code></li>
<li>Choose:
<ul>
<li><strong>Method:</strong> <em>Try all</em><br>
</li>
<li><strong>White objects</strong><br>
</li>
</ul></li>
<li>Confirm.</li>
</ol>
<p>Fiji generates a montage of all global methods:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/AutoThresh.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Global auto threshold montage"><img src="images/AutoThresh.png" class="img-fluid figure-img" alt="Global auto threshold montage"></a></p>
<figcaption>Global auto threshold montage</figcaption>
</figure>
</div>
</section>
<section id="prepare-the-image-for-auto-local-threshold" class="level3">
<h3 class="anchored" data-anchor-id="prepare-the-image-for-auto-local-threshold">3. Prepare the image for Auto Local Threshold</h3>
<p>Local thresholding requires <strong>8-bit</strong> input.</p>
<ol type="1">
<li>Select the original image:<br>
<code>Window ‚Üí MAX_Lund.tif</code></li>
<li>Convert to 8-bit:<br>
<code>Image ‚Üí Type ‚Üí 8-bit</code></li>
</ol>
<p>Now the image is ready for local methods.</p>
</section>
<section id="try-all-auto-local-threshold-methods" class="level3">
<h3 class="anchored" data-anchor-id="try-all-auto-local-threshold-methods">4. Try all Auto Local Threshold methods</h3>
<p>Local thresholding computes a threshold for each <strong>local neighborhood</strong>.</p>
<ol type="1">
<li>Run:<br>
<code>Image ‚Üí Adjust ‚Üí Auto Local Threshold‚Ä¶</code></li>
<li>Choose:
<ul>
<li><strong>Method:</strong> <em>Try all</em><br>
</li>
<li><strong>Radius:</strong> 15<br>
</li>
<li><strong>Parameter 1:</strong> 0<br>
</li>
<li><strong>Parameter 2:</strong> 0<br>
</li>
<li><strong>White objects</strong></li>
</ul></li>
<li>Confirm.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/AutoLocalThresh1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Local auto threshold montage"><img src="images/AutoLocalThresh1.png" class="img-fluid figure-img" alt="Local auto threshold montage"></a></p>
<figcaption>Local auto threshold montage</figcaption>
</figure>
</div>
</section>
<section id="improving-segmentation-with-background-subtraction-and-smoothing" class="level3">
<h3 class="anchored" data-anchor-id="improving-segmentation-with-background-subtraction-and-smoothing">5. Improving segmentation with background subtraction and smoothing</h3>
<p>Good segmentation often benefits from reducing background and noise first.</p>
<section id="remove-background-and-apply-gaussian-blur" class="level4">
<h4 class="anchored" data-anchor-id="remove-background-and-apply-gaussian-blur">5.1 Remove background and apply Gaussian blur</h4>
<ol type="1">
<li>Open <code>MAX_Lund.png</code>.<br>
</li>
<li>Subtract background:<br>
<code>Process ‚Üí Subtract Background‚Ä¶</code>
<ul>
<li>Rolling ball radius: <strong>50</strong><br>
</li>
</ul></li>
<li>Smooth noise:<br>
<code>Process ‚Üí Filters ‚Üí Gaussian Blur‚Ä¶</code>
<ul>
<li>Sigma: <strong>1</strong></li>
</ul></li>
</ol>
<p>After preprocessing:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/AutoLocalThresh2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Auto Local Threshold after preprocessing"><img src="images/AutoLocalThresh2.png" class="img-fluid figure-img" alt="Auto Local Threshold after preprocessing"></a></p>
<figcaption>Auto Local Threshold after preprocessing</figcaption>
</figure>
</div>
</section>
</section>
<section id="selecting-a-method-local-otsu-and-binary-cleanup" class="level3">
<h3 class="anchored" data-anchor-id="selecting-a-method-local-otsu-and-binary-cleanup">6. Selecting a method: Local Otsu and binary cleanup</h3>
<section id="apply-local-otsu-thresholding" class="level4">
<h4 class="anchored" data-anchor-id="apply-local-otsu-thresholding">6.1 Apply Local Otsu thresholding</h4>
<ol type="1">
<li>Run:<br>
<code>Image ‚Üí Adjust ‚Üí Auto Local Threshold‚Ä¶</code>
<ul>
<li><strong>Method:</strong> Otsu<br>
</li>
<li><strong>Radius:</strong> 15</li>
</ul></li>
</ol>
<p><strong>Local Otsu mask:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_Mask.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Local Otsu mask"><img src="images/MAX_Lund_Mask.png" class="img-fluid figure-img" alt="Local Otsu mask"></a></p>
<figcaption>Local Otsu mask</figcaption>
</figure>
</div>
</section>
<section id="refine-the-mask-with-binary-operations" class="level4">
<h4 class="anchored" data-anchor-id="refine-the-mask-with-binary-operations">6.2 Refine the mask with binary operations</h4>
<ol start="2" type="1">
<li>Fill holes inside objects:<br>
<code>Process ‚Üí Binary ‚Üí Fill Holes</code></li>
<li>Slightly shrink objects:<br>
<code>Process ‚Üí Binary ‚Üí Erode</code></li>
<li>Optionally restore outlines:<br>
<code>Edit ‚Üí Draw</code></li>
<li>Expand objects after erosion:<br>
<code>Process ‚Üí Binary ‚Üí Dilate</code></li>
</ol>
<p><strong>Refined mask:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_MaskErode.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Refined mask"><img src="images/MAX_Lund_MaskErode.png" class="img-fluid figure-img" alt="Refined mask"></a></p>
<figcaption>Refined mask</figcaption>
</figure>
</div>
</section>
<section id="remove-border-touching-objects" class="level4">
<h4 class="anchored" data-anchor-id="remove-border-touching-objects">6.3 Remove border-touching objects</h4>
<ol start="6" type="1">
<li>Remove partial objects touching image borders:<br>
<code>Plugins ‚Üí MorphoLibJ ‚Üí Filtering ‚Üí Kill Borders</code></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_Mask-killBorders.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Filled + border-removed mask"><img src="images/MAX_Lund_Mask-killBorders.png" class="img-fluid figure-img" alt="Filled + border-removed mask"></a></p>
<figcaption>Filled + border-removed mask</figcaption>
</figure>
</div>
</section>
</section>
<section id="object-labeling-with-morpholibj" class="level3">
<h3 class="anchored" data-anchor-id="object-labeling-with-morpholibj">7. Object labeling with MorphoLibJ</h3>
<p>Convert each connected region into a uniquely labeled object:</p>
<p><code>Plugins ‚Üí MorphoLibJ ‚Üí Label ‚Üí Connected Components Labeling</code></p>
<ul>
<li>Connectivity: <strong>4</strong><br>
</li>
<li>Output type: <strong>16-bit</strong></li>
</ul>
<p><strong>Labeled objects:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_Mask-killBorders-lbl.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Connected components labeling"><img src="images/MAX_Lund_Mask-killBorders-lbl.png" class="img-fluid figure-img" alt="Connected components labeling"></a></p>
<figcaption>Connected components labeling</figcaption>
</figure>
</div>
</section>
<section id="measuring-object-properties" class="level3">
<h3 class="anchored" data-anchor-id="measuring-object-properties">8. Measuring object properties</h3>
<p>Quantifying each object is often the main goal after segmentation.</p>
<p>Run measurements:</p>
<p><code>Plugins ‚Üí MorphoLibJ ‚Üí Analyze ‚Üí Analyze Regions</code></p>
<p>This extracts a number of morphological associated features. We will select:</p>
<ul>
<li>Area<br>
</li>
<li>Pixel count<br>
</li>
<li>Perimeter<br>
</li>
<li>Circularity<br>
</li>
<li>Ellipse geometry<br>
</li>
<li>Bounding box</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Screenshot2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Morphometry table"><img src="images/Screenshot2.png" class="img-fluid figure-img" alt="Morphometry table"></a></p>
<figcaption>Morphometry table</figcaption>
</figure>
</div>
</section>
<section id="visualizing-label-properties" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-label-properties">9. Visualizing label properties</h3>
<p>Visualize one measurement (e.g.&nbsp;area) mapped onto the label image:</p>
<p><code>Plugins ‚Üí MorphoLibJ ‚Üí Label Images ‚Üí Assign Measure to Label</code></p>
<p>Choose <strong>Area</strong> and apply a colormap.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_Mask-killBorders-lbl-Area.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Area visualization on labels"><img src="images/MAX_Lund_Mask-killBorders-lbl-Area.png" class="img-fluid figure-img" alt="Area visualization on labels"></a></p>
<figcaption>Area visualization on labels</figcaption>
</figure>
</div>
<p>Useful for:</p>
<ul>
<li>spotting unusually big/small objects<br>
</li>
<li>deciding filtering thresholds<br>
</li>
<li>checking measurement correctness</li>
</ul>
</section>
<section id="filtering-objects-by-size" class="level3">
<h3 class="anchored" data-anchor-id="filtering-objects-by-size">10. Filtering objects by size</h3>
<p>Remove small objects based on size:</p>
<p><code>Plugins ‚Üí MorphoLibJ ‚Üí Label Images ‚Üí Label Size Filtering</code></p>
<ul>
<li><strong>Operation:</strong> Lower Than<br>
</li>
<li><strong>Size threshold:</strong> 100 px</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/MAX_Lund_Mask-killBorders-lbl-sizeFilt.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Size filtering"><img src="images/MAX_Lund_Mask-killBorders-lbl-sizeFilt.png" class="img-fluid figure-img" alt="Size filtering"></a></p>
<figcaption>Size filtering</figcaption>
</figure>
</div>
</section>
</section>
<section id="d-segmentation-in-napari" class="level2">
<h2 class="anchored" data-anchor-id="d-segmentation-in-napari">3D segmentation in Napari</h2>
<p>In this exercise we will:</p>
<ul>
<li>Use Napari to open a 3D image</li>
<li>Use Napari assistant to visualize a workflow for 3D image segmentation and labelling</li>
<li>Use region props to quantify morphological parameters and make colorcoded plots</li>
</ul>
<p>These steps form a complete workflow:<br>
<strong>raw image ‚Üí pre-processing ‚Üí segmentation ‚Üí cleanup ‚Üí labeling ‚Üí measurement ‚Üí filtering</strong></p>
<p>We‚Äôll use <code>Lund.tif</code> as the example image https://zenodo.org/records/17986091.</p>
<p>Requirements: - Everything you need is in the toml file in the Pixi/napari-assistant folder https://github.com/cuenca-mb/pixi-napari-assistant</p>
<section id="open-napari-assistant-using-pixi" class="level3">
<h3 class="anchored" data-anchor-id="open-napari-assistant-using-pixi">0. Open Napari assistant using Pixi</h3>
<p>In the terminal, go to the directory Pixi/napari-assistant and run:</p>
<p><code>pixi run assistant</code></p>
</section>
<section id="open-a-3d-stack" class="level3">
<h3 class="anchored" data-anchor-id="open-a-3d-stack">1. Open a 3D stack</h3>
<p>Drag and drop the file or</p>
<p><code>File ‚Üí Open File</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-load.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Brightness/Contrast histogram"><img src="images/Napari-load.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>We will be able to see and explore the stack, and we can change to a 3D rendering with the option <code>Toogle 2D/3D view</code> in the lower left button pannel. We can also make orthogonal views by clicking the button to the right <code>Change order of the visible axis</code>.</p>
<p>In the right pannel we will see the Assistant plugin, where it suggests operations in the appropriate order. The amount of operations and options depends on your installed plugins. Some of them are redundant.</p>
</section>
<section id="remove-background-binarization-and-labeling" class="level3">
<h3 class="anchored" data-anchor-id="remove-background-binarization-and-labeling">2. Remove background, binarization and labeling</h3>
<p>Select <code>Remove Background ‚Üí White top hat  ‚Üí radius = 10</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-bkg.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Brightness/Contrast histogram"><img src="images/Napari-bkg.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>Then select <code>Binarize ‚Üí Threshold Yen</code>, making sure to select the Result of White top-hat image.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-thresh.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Brightness/Contrast histogram"><img src="images/Napari-thresh.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>I recommend looking at the result in 3D.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-3D.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Brightness/Contrast histogram"><img src="images/Napari-3D.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>Finally, we can select <code>Label ‚Üí Connected component labeling</code>, make sure to select the Result of Threshold image. We can additionally select the <code>exclude on edges option</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-labels.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Brightness/Contrast histogram"><img src="images/Napari-labels.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>Some of them are stuck together. Let‚Äôs try and fix that.</p>
</section>
<section id="fix-labels" class="level3">
<h3 class="anchored" data-anchor-id="fix-labels">3. Fix labels</h3>
<p>Let‚Äôs select again the previous layer Result of Threshold. Then select <code>Process labels ‚Üí Binary erosion ‚Üí radius = 3</code>. This will reduce the objects of the binary segmentation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-erode.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Brightness/Contrast histogram"><img src="images/Napari-erode.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>Now let‚Äôs recreate the labels <code>Label ‚Üí Connected component labeling</code>, make sure to select the Result of Binary Erosion.</p>
<p>Then <code>Process labels ‚Üí Expand Labels ‚Üí radius = 3</code>. Explore the labels in 3D.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-extend.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Brightness/Contrast histogram"><img src="images/Napari-extend.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>Now we can accurately measure morphological features of these labels. You can close the assistant pannel now.</p>
</section>
<section id="measure-morphological-properties" class="level3">
<h3 class="anchored" data-anchor-id="measure-morphological-properties">4. Measure morphological properties</h3>
<p>Select <code>Tools ‚Üí Measure Tables ‚Üí Object Features/Properties</code>. Here make sure to select the Result of Expanded Labels image. You can select different features, includding intensity features extracted from the raw data. After running a table should appear which can be exported in csv format.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-table.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Brightness/Contrast histogram"><img src="images/Napari-table.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-table2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Brightness/Contrast histogram"><img src="images/Napari-table2.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>
<p>by double clicking any of the columns of this table, a new layer image will appear with colorcoded labels indicating the value of the selected measurement. Colormaps can be adjusted for preference.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Napari-colorcoded.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Brightness/Contrast histogram"><img src="images/Napari-colorcoded.png" class="img-fluid figure-img" alt="Brightness/Contrast histogram"></a></p>
<figcaption>Brightness/Contrast histogram</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bruvellu\.github\.io\/light-sheet-image-analysis-workshop-2026");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../practicals/practical_3d/index.html" class="pagination-link" aria-label="Visualization of 3D images">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Visualization of 3D images</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../practicals/practical_cartography/index.html" class="pagination-link" aria-label="Tissue cartography">
        <span class="nav-page-text">Tissue cartography</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://lightsheetchile.cl/light-sheet-image-analysis-workshop-2026-2/">
<p>LiSIUM</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_segmentation/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>