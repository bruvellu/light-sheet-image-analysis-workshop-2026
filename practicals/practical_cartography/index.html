<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bruno Vellutini">
<meta name="dcterms.date" content="2026-01-05">

<title>Tissue cartography using Blender ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../practicals/practical_deep_learning_segmentation/index.html" rel="next">
<link href="../../practicals/practical_3d/index.html" rel="prev">
<link href="../../media/lisium.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-635a35c16803d16fd9db22f392043487.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Tissue cartography using Blender ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:description" content="">
<meta property="og:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_cartography/media/14-features-window.png">
<meta property="og:site_name" content="üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta property="og:image:height" content="397">
<meta property="og:image:width" content="661">
<meta name="twitter:title" content="Tissue cartography using Blender ‚Äì üî¨ Light-Sheet Image Analysis Workshop 2026">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://bruvellu.github.io/light-sheet-image-analysis-workshop-2026/practicals/practical_cartography/media/14-features-window.png">
<meta name="twitter:image-height" content="397">
<meta name="twitter:image-width" content="661">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">üî¨ Light-Sheet Image Analysis Workshop 2026</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_2d/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_cartography/index.html">Tissue cartography using Blender</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Program</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Practicals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_2d/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 2D data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_3d/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization of 3D data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_cartography/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Tissue cartography using Blender</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_deep_learning_segmentation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3D Deep Learning Segmentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_macros/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Macro programming in Fiji</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_multiview/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction using BigStitcher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_object_classification/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Object-classification, dimensionality reduction and clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_segmentation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post-processing, segmentation and labelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../practicals/practical_tracking/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cell tracking using Mastodon</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Talks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_data_management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best practices in microscopy data management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_deep_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep learning for image analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_digital_images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization and processing of digital images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_experimental_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental design and sample mounting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_image_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image processing and analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_lightsheet_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principles of light-sheet microscopy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../talks/talk_multiview_cartography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiview reconstruction and tissue cartography</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-summary" id="toc-sec-summary" class="nav-link active" data-scroll-target="#sec-summary">Summary</a></li>
  <li><a href="#sec-requirements" id="toc-sec-requirements" class="nav-link" data-scroll-target="#sec-requirements">Requirements</a></li>
  <li><a href="#sec-setup" id="toc-sec-setup" class="nav-link" data-scroll-target="#sec-setup">Setup</a>
  <ul>
  <li><a href="#download-blender-tissue-cartography" id="toc-download-blender-tissue-cartography" class="nav-link" data-scroll-target="#download-blender-tissue-cartography">Download Blender Tissue Cartography</a></li>
  <li><a href="#download-blender" id="toc-download-blender" class="nav-link" data-scroll-target="#download-blender">Download Blender</a></li>
  <li><a href="#install-blender-tissue-cartography" id="toc-install-blender-tissue-cartography" class="nav-link" data-scroll-target="#install-blender-tissue-cartography">Install Blender Tissue Cartography</a></li>
  <li><a href="#download-ilastik" id="toc-download-ilastik" class="nav-link" data-scroll-target="#download-ilastik">Download ilastik</a></li>
  <li><a href="#download-fiji" id="toc-download-fiji" class="nav-link" data-scroll-target="#download-fiji">Download Fiji</a></li>
  </ul></li>
  <li><a href="#sec-inspect-dataset" id="toc-sec-inspect-dataset" class="nav-link" data-scroll-target="#sec-inspect-dataset">Inspect dataset in Fiji</a></li>
  <li><a href="#sec-segment-tissues" id="toc-sec-segment-tissues" class="nav-link" data-scroll-target="#sec-segment-tissues">Segment tissues in ilastik</a>
  <ul>
  <li><a href="#create-project" id="toc-create-project" class="nav-link" data-scroll-target="#create-project">Create project</a></li>
  <li><a href="#input-data" id="toc-input-data" class="nav-link" data-scroll-target="#input-data">Input Data</a></li>
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection">Feature Selection</a></li>
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training">Training</a></li>
  <li><a href="#prediction-export" id="toc-prediction-export" class="nav-link" data-scroll-target="#prediction-export">Prediction Export</a></li>
  </ul></li>
  <li><a href="#sec-import-blender" id="toc-sec-import-blender" class="nav-link" data-scroll-target="#sec-import-blender">Import data to Blender</a>
  <ul>
  <li><a href="#open-blender" id="toc-open-blender" class="nav-link" data-scroll-target="#open-blender">Open Blender</a></li>
  <li><a href="#load-sample" id="toc-load-sample" class="nav-link" data-scroll-target="#load-sample">Load sample</a></li>
  <li><a href="#load-probabilities" id="toc-load-probabilities" class="nav-link" data-scroll-target="#load-probabilities">Load probabilities</a></li>
  <li><a href="#apply-shading" id="toc-apply-shading" class="nav-link" data-scroll-target="#apply-shading">Apply shading</a></li>
  </ul></li>
  <li><a href="#sec-generate-projection" id="toc-sec-generate-projection" class="nav-link" data-scroll-target="#sec-generate-projection">Generate projection</a>
  <ul>
  <li><a href="#sec-setup-uv" id="toc-sec-setup-uv" class="nav-link" data-scroll-target="#sec-setup-uv">Set up UV Editing</a></li>
  <li><a href="#sec-project-mesh" id="toc-sec-project-mesh" class="nav-link" data-scroll-target="#sec-project-mesh">Project mesh</a></li>
  <li><a href="#sec-project-data" id="toc-sec-project-data" class="nav-link" data-scroll-target="#sec-project-data">Project data</a></li>
  <li><a href="#sec-check-projection" id="toc-sec-check-projection" class="nav-link" data-scroll-target="#sec-check-projection">Check projection</a></li>
  <li><a href="#sec-save-projection" id="toc-sec-save-projection" class="nav-link" data-scroll-target="#sec-save-projection">Save projection</a></li>
  <li><a href="#sec-open-projection" id="toc-sec-open-projection" class="nav-link" data-scroll-target="#sec-open-projection">Open projection</a></li>
  </ul></li>
  <li><a href="#sec-optimize-projection" id="toc-sec-optimize-projection" class="nav-link" data-scroll-target="#sec-optimize-projection">Optimize projection</a>
  <ul>
  <li><a href="#sec-mark-seam" id="toc-sec-mark-seam" class="nav-link" data-scroll-target="#sec-mark-seam">Mark seam on mesh</a></li>
  <li><a href="#sec-project-mesh-seam" id="toc-sec-project-mesh-seam" class="nav-link" data-scroll-target="#sec-project-mesh-seam">Project mesh with seam</a></li>
  <li><a href="#sec-project-data-seam" id="toc-sec-project-data-seam" class="nav-link" data-scroll-target="#sec-project-data-seam">Project data with seam</a></li>
  <li><a href="#sec-edit-projected-mesh" id="toc-sec-edit-projected-mesh" class="nav-link" data-scroll-target="#sec-edit-projected-mesh">Edit projected mesh</a></li>
  <li><a href="#sec-check-edited-mesh" id="toc-sec-check-edited-mesh" class="nav-link" data-scroll-target="#sec-check-edited-mesh">Check edited projection</a></li>
  </ul></li>
  <li><a href="#sec-citation" id="toc-sec-citation" class="nav-link" data-scroll-target="#sec-citation">Citation</a></li>
  <li><a href="#sec-license" id="toc-sec-license" class="nav-link" data-scroll-target="#sec-license">License</a></li>
  <li><a href="#sec-references" id="toc-sec-references" class="nav-link" data-scroll-target="#sec-references">References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_cartography/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../practicals/practical_2d/index.html">Practicals</a></li><li class="breadcrumb-item"><a href="../../practicals/practical_cartography/index.html">Tissue cartography using Blender</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Tissue cartography using Blender</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bruno Vellutini </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 5, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="sec-summary" class="level2">
<h2 class="anchored" data-anchor-id="sec-summary">Summary</h2>
<p>Tissue cartography is the art of projecting a tridimensional surface, usually of a biological sample, into a 2D surface. This is useful to visualize and analyze complex 3D microscopy data.</p>
<p>The state-of-the-art approach to generate cartographic projections was the MATLAB-based ImSAnE toolbox <span class="citation" data-cites="Heemskerk2015-kv">(<a href="#ref-Heemskerk2015-kv" role="doc-biblioref">Heemskerk and Streichan 2015</a>)</span>. However, more recently, a Blender-based tool was released, known as <em>Blender Tissue Cartography</em> <span class="citation" data-cites="Claussen2025-pv">(<a href="#ref-Claussen2025-pv" role="doc-biblioref">Claussen et al. 2025</a>)</span> (<a href="https://github.com/nikolas-claussen/blender-tissue-cartography">code repository</a>). This tool has an <a href="https://nikolas-claussen.github.io/blender-tissue-cartography/">extensive documentation</a> and several <a href="https://nikolas-claussen.github.io/blender-tissue-cartography/00_tissue_cartography_overview.html#tutorials">in-depth tutorials</a> that I highly recommend anyone interested in tissue cartography to read.</p>
<p>This tutorial is a simplified version of the Blender Tissue Cartography tutorials. It is targeted to beginners wanting to learn the basics of tissue cartography, focusing on a single approach. It shows how to generate cartographic projections from 3D lightsheet microscopy data using Fiji to inspect data, ilastik to segment the tissues, and Blender with the Blender Tissue Cartography add-on to create the projections.</p>
<p>If you want to generate cartographic projections using the MATLAB-based ImSAnE toolbox <span class="citation" data-cites="Heemskerk2015-kv">(<a href="#ref-Heemskerk2015-kv" role="doc-biblioref">Heemskerk and Streichan 2015</a>)</span>, please check the <a href="https://github.com/bruvellu/imsane-tutorial">imsane-tutorial</a> which explains how to set up and run the pipeline <span class="citation" data-cites="Vellutini2022-ya">(<a href="#ref-Vellutini2022-ya" role="doc-biblioref">Vellutini 2022</a>)</span>.</p>
</section>
<section id="sec-requirements" class="level2">
<h2 class="anchored" data-anchor-id="sec-requirements">Requirements</h2>
<ul>
<li><a href="https://fiji.sc">Fiji</a> <span class="citation" data-cites="Schindelin2012-di">(<a href="#ref-Schindelin2012-di" role="doc-biblioref">Schindelin et al. 2012</a>)</span></li>
<li><a href="https://www.ilastik.org">ilastik</a> v1.4.1.post1 <span class="citation" data-cites="Berg2019-ab">(<a href="#ref-Berg2019-ab" role="doc-biblioref">Berg et al. 2019</a>)</span></li>
<li><a href="https://www.blender.org">Blender</a> v4.2.9 <span class="citation" data-cites="Blender-Foundation2002-jm">(<a href="#ref-Blender-Foundation2002-jm" role="doc-biblioref">Blender Foundation 2002</a>)</span></li>
<li><a href="https://github.com/nikolas-claussen/blender-tissue-cartography">Blender Tissue Cartography</a> (Blender add-on) <span class="citation" data-cites="Claussen2025-pv">(<a href="#ref-Claussen2025-pv" role="doc-biblioref">Claussen et al. 2025</a>)</span></li>
<li><code>Drosophila_CAAX-mCherry.tif</code> dataset from Blender Tissue Cartography (available <a href="https://github.com/nikolas-claussen/blender-tissue-cartography/blob/main/nbs/Tutorials/drosophila_example/">here</a>) <span class="citation" data-cites="Claussen2025-pv">(<a href="#ref-Claussen2025-pv" role="doc-biblioref">Claussen et al. 2025</a>)</span></li>
</ul>
</section>
<section id="sec-setup" class="level2">
<h2 class="anchored" data-anchor-id="sec-setup">Setup</h2>
<section id="download-blender-tissue-cartography" class="level3">
<h3 class="anchored" data-anchor-id="download-blender-tissue-cartography">Download Blender Tissue Cartography</h3>
<ul>
<li>Go to <a href="https://github.com/nikolas-claussen/blender-tissue-cartography" class="uri">https://github.com/nikolas-claussen/blender-tissue-cartography</a>.</li>
<li>Press the green button named <code>Code</code> &gt; <code>Download ZIP</code> to begin the download (or press <a href="https://github.com/nikolas-claussen/blender-tissue-cartography/archive/refs/heads/main.zip">here</a>).</li>
<li>Unzip the contents in your working directory.</li>
<li>You should see a new directory named <code>blender-tissue-cartography</code>.</li>
<li>Copy the file <code>Drosophila_CAAX-mCherry.tif</code> located at <code>blender-tissue-cartography/nbs/Tutorials/drosophila_example/</code> to your working directory.</li>
</ul>
</section>
<section id="download-blender" class="level3">
<h3 class="anchored" data-anchor-id="download-blender">Download Blender</h3>
<ul>
<li>Go to <a href="https://download.blender.org/release/Blender4.2/" class="uri">https://download.blender.org/release/Blender4.2/</a>.</li>
<li>Download Blender 4.2.9 (direct link for <a href="https://download.blender.org/release/Blender4.2/blender-4.2.9-linux-x64.tar.xz">Linux</a>/<a href="https://download.blender.org/release/Blender4.2/blender-4.2.9-macos-x64.dmg">MacOS</a>/<a href="https://download.blender.org/release/Blender4.2/blender-4.2.9-windows-x64.msi">Windows</a>).</li>
<li>Unzip the file into your working directory.</li>
<li>You should see a new directory named <code>blender-4.2.9-linux-x64</code> (or similar for other systems).</li>
</ul>
<p>Note that older or newer versions of Blender might not work. Use v4.2.9 as it is known to work with this tutorial.</p>
</section>
<section id="install-blender-tissue-cartography" class="level3">
<h3 class="anchored" data-anchor-id="install-blender-tissue-cartography">Install Blender Tissue Cartography</h3>
<ul>
<li>Open the directory <code>blender-4.2.9-linux-x64</code>.</li>
<li>Double-click the file <code>blender</code> to open the program.</li>
<li>Go to <code>Edit</code> &gt; <code>Preferences</code> &gt; <code>Add-ons</code> &gt; <code>Add-ons Settings</code> (down arrow) &gt; <code>Install from Disk...</code>.</li>
<li>Select the file <code>blender_tissue_cartography-1.0.0-linux_x64.zip</code> located in the directory <code>blender-tissue-cartography/blender_addon/</code>.</li>
<li>Close Blender.</li>
</ul>
</section>
<section id="download-ilastik" class="level3">
<h3 class="anchored" data-anchor-id="download-ilastik">Download ilastik</h3>
<ul>
<li>Go to <a href="https://www.ilastik.org/download" class="uri">https://www.ilastik.org/download</a>.</li>
<li>Download ilastik 1.4.1.post1 (direct link for <a href="https://files.ilastik.org/ilastik-1.4.1.post1-Linux.tar.bz2">Linux</a>/<a href="https://files.ilastik.org/ilastik-1.4.1.post1-OSX.zip">MacOS</a>/<a href="https://files.ilastik.org/ilastik-1.4.1.post1-win64.exe">Windows</a>).</li>
<li>Unzip the file into your working directory.</li>
<li>You should see a new directory named <code>ilastik-1.4.1.post1-Linux</code>.</li>
</ul>
</section>
<section id="download-fiji" class="level3">
<h3 class="anchored" data-anchor-id="download-fiji">Download Fiji</h3>
<ul>
<li>Go to <a href="https://fiji.sc" class="uri">https://fiji.sc</a>.</li>
<li>Choose <code>Distribution: Stable</code> then click the big download button.</li>
<li>Unzip the file into your working directory.</li>
<li>You should see a new directory named <code>fiji-stable-linux64-jdk</code>.</li>
</ul>
</section>
</section>
<section id="sec-inspect-dataset" class="level2">
<h2 class="anchored" data-anchor-id="sec-inspect-dataset">Inspect dataset in Fiji</h2>
<p>Before starting, let‚Äôs inspect the <code>Drosophila_CAAX-mCherry.tif</code> dataset in Fiji.</p>
<ul>
<li>Open the directory <code>fiji-stable-linux64-jdk/Fiji.app/</code> and double-click the <code>fiji-linux-x64</code> launcher.</li>
</ul>
<p><a href="media/01-fiji-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="media/01-fiji-open.png" class="img-fluid"></a></p>
<ul>
<li>Drag and drop <code>Drosophila_CAAX-mCherry.tif</code> in the Fiji window to open it.</li>
<li>Scroll through the Z slices of the stack.</li>
</ul>
<p><a href="media/02-data-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="media/02-data-open.png" class="img-fluid"></a></p>
<ul>
<li>To get more information, activate the orthogonal views with <code>Image</code> &gt; <code>Stacks</code> &gt; <code>Orthogonal Views</code> (or <code>Ctrl+Shift+H</code>).</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/03-orthogonal-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="media/03-orthogonal-open.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/04-orthogonal-views.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="media/04-orthogonal-views.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>Explore the sample to understand well its shape. Try to figure out which side of the embryo is dorsal, which is ventral, and what is left/right. Also notice what are the characteristics of the tissues and of the background regions and think about the potential issues we might encounter with this dataset.</p>
<ul>
<li>Once done, close the orthogonal views and stack (leave Fiji open).</li>
</ul>
</section>
<section id="sec-segment-tissues" class="level2">
<h2 class="anchored" data-anchor-id="sec-segment-tissues">Segment tissues in ilastik</h2>
<p>The first step we need is to segment the stack in 3D to distinguish what is tissue and what is background. This is required to create a 3D mesh in Blender that has the shape of the sample. To accomplish that, we will use ilastik.</p>
<ul>
<li>Open the directory <code>ilastik-1.4.1.post1-Linux</code>, right-click the file <code>run_ilastik.sh</code>, and select <code>Run as a Program</code> to open ilastik.</li>
</ul>
<p><a href="media/05-ilastik-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="media/05-ilastik-open.png" class="img-fluid"></a></p>
<section id="create-project" class="level3">
<h3 class="anchored" data-anchor-id="create-project">Create project</h3>
<ul>
<li>Maximize the interface (we will need it).</li>
<li>Under <code>Create New Project</code>, click on <code>Pixel Classification</code>.</li>
</ul>
<p><a href="media/06-ilastik-pixel.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="media/06-ilastik-pixel.png" class="img-fluid"></a></p>
<p>The window <code>Create Ilastik Project</code> will open.</p>
<ul>
<li>Navigate to your working directory and click <code>Save</code>.</li>
</ul>
<p><a href="media/07-ilastik-project.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="media/07-ilastik-project.png" class="img-fluid"></a></p>
<p>A file named <code>MyProject.ilp</code> will be created.</p>
</section>
<section id="input-data" class="level3">
<h3 class="anchored" data-anchor-id="input-data">Input Data</h3>
<p>The ilastik interface is ready to define our input data.</p>
<ul>
<li>Under the <code>Raw Data</code> tab, click on <code>Add New...</code> &gt; <code>Add separate Image(s)...</code>.</li>
</ul>
<p><a href="media/08-ilastik-add.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="media/08-ilastik-add.png" class="img-fluid"></a></p>
<ul>
<li>Then, select the file <code>Drosophila_CAAX-mCherry.tif</code>.</li>
</ul>
<p><a href="media/09-ilastik-select.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="media/09-ilastik-select.png" class="img-fluid"></a></p>
<p>ilastik will open the dataset in three orthogonal views: XY (blue), XZ (green), YZ (red).</p>
<p><a href="media/10-ilastik-dataset.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="media/10-ilastik-dataset.png" class="img-fluid"></a></p>
<p>Note, however, that the images are too dark; let‚Äôs fix this.</p>
<ul>
<li>Right-click the dataset row and select <code>Edit properties...</code>.</li>
<li>Change the value of <code>Normalize Display</code> to <code>True</code> and set the <code>Range</code> maximum value to <code>10000</code>.</li>
<li>Press <code>OK</code>.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/11-ilastik-adjust.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="media/11-ilastik-adjust.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/12-ilastik-properties.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="media/12-ilastik-properties.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>The contrast will be much better now.</p>
<p><a href="media/13-ilastik-adjusted.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="media/13-ilastik-adjusted.png" class="img-fluid"></a></p>
</section>
<section id="feature-selection" class="level3">
<h3 class="anchored" data-anchor-id="feature-selection">Feature Selection</h3>
<p>Next we need to select the image features to take into account for the segmentation.</p>
<ul>
<li>On the left column press <code>2. Feature Selection</code>; the interface will update.</li>
<li>Then press <code>Select Features...</code> to open the <code>Features</code> window.</li>
<li>Select all the features and press <code>OK</code>.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/14-features-window.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="media/14-features-window.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/15-features-selected.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="media/15-features-selected.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section>
<section id="training" class="level3">
<h3 class="anchored" data-anchor-id="training">Training</h3>
<ul>
<li>On the left column, click <code>3. Training</code>.</li>
</ul>
<p>A new toolbox will open underneath showing two labels, Label 1 (yellow) and Label 2 (blue), buttons for paint or eraser modes, a size drop-down menu, and a <code>Live Update</code> button.</p>
<p><a href="media/16-training-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="media/16-training-open.png" class="img-fluid"></a></p>
<p>Now is a good time to get familiar with the basic ilastik commands.</p>
<ul>
<li><code>Scroll forward</code>: go down through the slices of the orthogonal dimension.</li>
<li><code>Scroll backward</code>: go up through the slices of the orthogonal dimension.</li>
<li><code>Ctrl+Scroll forward</code>: zoom in.</li>
<li><code>Ctrl+Scroll backward</code>: zoom out.</li>
<li><code>Middle-click and hold</code>: drag view around.</li>
</ul>
<p>Learn how to zoom in/out, go through the slices, and drag the view. If we are able to zoom in significantly, and reach the top or bottom of a view by dragging, we are ready for painting.</p>
<p><a href="media/17-training-drag.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="media/17-training-drag.png" class="img-fluid"></a></p>
<p>Our goal is to paint tissues in yellow and background in blue. But to accomplish that, we only need a few strokes at the right regions of the image.</p>
<ul>
<li>Begin by zooming in at the top region of the XZ (green) view.</li>
<li>Select Label 2 (blue), change the size to <code>7</code>, and paint a line right above the tissue.</li>
<li>Now select Label 1 (yellow) and paint the tissue immediately below the blue line.</li>
</ul>
<p><a href="media/18-training-paint.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="media/18-training-paint.png" class="img-fluid"></a></p>
<p>These two simple lines are indicating to ilastik that all the image features in this region very close to the tissue correspond to ‚Äúbackground‚Äù, and that the image features of the tissue below correspond to ‚Äúforeground‚Äù. Putting the two lines adjacent to each other also helps ilastik to understand where the boundaries are.</p>
<ul>
<li>Since we want all of the tissue to be segmented (and not just the surface), also paint a line until the center of the embryo.</li>
</ul>
<p>This is enough to get started. Based on these simple strokes, ilastik will learn and apply this to the entire dataset.</p>
<ul>
<li>To start the training, press the button <code>Live Update</code>.</li>
</ul>
<p><a href="media/19-training-live.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="media/19-training-live.png" class="img-fluid"></a></p>
<p>ilastik will overlay the current segmentation model over the image. We should see that most of the tissue regions are yellow and that the region around the embryo is more blue. The more vivid the color, the more confident the model is about that specific region.</p>
<p>Now start painting with simple strokes areas which are wrong or pale. For example the corners of the images are background and should be blue; any area inside the sample should be yellow; use different brush sizes if needed; or the eraser. This sample also has giant, super bright beads; they are not tissue, we want them blue.</p>
<p>Note that the segmentation model and overlay colors update upon each stroke, so we can see if what we did improved or worsened the segmentation. If it got worse, we can always erase the annotation.</p>
<p><a href="media/20-training-better.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="media/20-training-better.png" class="img-fluid"></a></p>
<p>Be meticulous and pay special attention to the edges of the image. We do not want tissue (yellow) to be touching the border, because this will create a hole in the segmentation. The better the segmentation is, the better will be our visualization and cartographic projection.</p>
<p>There are ways that we can fix segmentation issues after converting it to a mesh, but they will not be covered in this tutorial. So, for this image, it is important to take care of the tip of the very top part of the sample because it is touching the edge.</p>
<ul>
<li>Use a size <code>1</code> brush to place a couple of blue lines at the very top.</li>
</ul>
<p><a href="media/21-training-tip.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="media/21-training-tip.png" class="img-fluid"></a></p>
<ul>
<li>Go through the slices in each of the orthogonal views to fix any leftover segmentation uncertainties.</li>
</ul>
<p><a href="media/22-training-done.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="media/22-training-done.png" class="img-fluid"></a></p>
<p>The segmentation overlay should be showing clearly separated yellow and blue regions that match the embryo and background.</p>
</section>
<section id="prediction-export" class="level3">
<h3 class="anchored" data-anchor-id="prediction-export">Prediction Export</h3>
<p>We can now export the segmentation prediction.</p>
<ul>
<li>On the left column, click on <code>4. Prediction Export</code>.</li>
<li>Under <code>Export Settings</code> keep the <code>Source</code> value as <code>Probabilities</code>.</li>
</ul>
<p><a href="media/23-prediction-export.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="media/23-prediction-export.png" class="img-fluid"></a></p>
<ul>
<li>Then, press <code>Choose Export Image Settings...</code> to open the <code>Image Export Options</code> window.</li>
</ul>
<p><a href="media/24-prediction-options.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="media/24-prediction-options.png" class="img-fluid"></a></p>
<p>There are two options that we need to change.</p>
<ul>
<li>Under <code>Cutout Subregion</code> uncheck the row <code>c</code> (for channels) and change the stop value to <code>1</code>.</li>
</ul>
<p>Since this image has only one channel, changing this option avoids loading a duplicated channel into Blender.</p>
<ul>
<li>Under <code>Output File Info</code> change the value of <code>Format</code> to <code>multipage tiff</code>.</li>
</ul>
<p>This is required to be able to load the segmentation into Blender.</p>
<ul>
<li>Press <code>OK</code> to close the window.</li>
<li>Then press the <code>Export All</code> button and wait‚Ä¶</li>
</ul>
<p>When the prediction is done, a new file will appear in the working directory named <code>Drosophila_CAAX-mCherry_Probabilities.tiff</code>.</p>
<p><a href="media/25-prediction-done.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="media/25-prediction-done.png" class="img-fluid"></a></p>
<ul>
<li>Open this file in Fiji to see how it looks before our next step in the tutorial.</li>
</ul>
<p><a href="media/26-fiji-probabilities.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="media/26-fiji-probabilities.png" class="img-fluid"></a></p>
<ul>
<li>Now close the file and let‚Äôs start with generating the actual projection.</li>
</ul>
</section>
</section>
<section id="sec-import-blender" class="level2">
<h2 class="anchored" data-anchor-id="sec-import-blender">Import data to Blender</h2>
<p>We can now import the image stack and segmentation probabilities into Blender.</p>
<section id="open-blender" class="level3">
<h3 class="anchored" data-anchor-id="open-blender">Open Blender</h3>
<ul>
<li>Enter the directory <code>blender-4.2.9-linux-x64</code> and double-click the file <code>blender</code>.</li>
</ul>
<p><a href="media/27-blender-open.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="media/27-blender-open.png" class="img-fluid"></a></p>
<p>Blender will open with a nice splash screen at the center.</p>
<ul>
<li>Click anywhere to close it.</li>
</ul>
<p><a href="media/28-blender-clean.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="media/28-blender-clean.png" class="img-fluid"></a></p>
<p>Notice at the top left region that we are in the <code>Layout</code> tab (important for later). There‚Äôs a gray cube at the center, we want to get rid of it.</p>
<ul>
<li>In the top right panel under <code>Scene Collection</code> &gt; <code>Collection</code>, right-click the <code>Cube</code> line and select <code>Delete</code>.</li>
</ul>
<p><a href="media/29-blender-cube.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="media/29-blender-cube.png" class="img-fluid"></a></p>
<p>Great. Let‚Äôs focus now at the bottom right corner, it is busy, full of icons and menus. Don‚Äôt get overwhelmed, we only need to select and use one of the modes.</p>
<ul>
<li>If not yet selected, click on the <code>Scene</code> icon (it is the white triangle with two circles) to activate this panel.</li>
<li>Then locate the tab named <code>Tissue Cartography</code> at the bottom.</li>
</ul>
<p><a href="media/30-blender-btc.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="media/30-blender-btc.png" class="img-fluid"></a></p>
<ul>
<li>Scroll down and make the side panels wider to be able to read the options of <code>Tissue Cartography</code>.</li>
</ul>
<p><a href="media/31-blender-wider.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="media/31-blender-wider.png" class="img-fluid"></a></p>
<p>This is the main interface of the <code>Blender Tissue Cartography</code> add-on. It is through here that we will control most of the steps of this pipeline.</p>
</section>
<section id="load-sample" class="level3">
<h3 class="anchored" data-anchor-id="load-sample">Load sample</h3>
<p>The first thing we need to do is to load the sample.</p>
<ul>
<li>Click on the folder icon in the <code>Tissue Cartography</code> &gt; <code>File Path</code>, navigate to the working directory, and select the file <code>Drosophila_CAAX-mCherry.tiff</code>.</li>
</ul>
<p>Tip: bookmark the directory for easy access in the future.</p>
<ul>
<li>Click <code>Accept</code>.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/32-blender-openpath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="media/32-blender-openpath.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/33-blender-filepath.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="media/33-blender-filepath.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>Then press <code>Load .tiff file</code> to load it into Blender.</li>
</ul>
<p><a href="media/34-blender-loaded.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="media/34-blender-loaded.png" class="img-fluid"></a></p>
<p>A new row will appear at the top right panel under <code>Scene Collection</code> &gt; <code>Collection</code> named <code>Drosophila_CAAX-mCherry_BoundingBox</code> and the bounding box of the image stack will be visible in the main window as orange lines.</p>
<p>Only a portion of the bounding box is visible, but we want to see the whole thing. The controls to navigate the 3D space are at the top right corner of the main window. We have XYZ handles (red, green, blue), a zoom tool (magnifier lens), and a move tool (open hand).</p>
<ul>
<li>Click, hold, and drag any of these to move around.</li>
<li>Clicking on the X, Y, or Z will reorient the sample along these axes (very useful).</li>
</ul>
<p><a href="media/35-blender-box.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="media/35-blender-box.png" class="img-fluid"></a></p>
<p>Take some time to practice and finish by placing the bounding box at the center of the main window as in the image below.</p>
</section>
<section id="load-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="load-probabilities">Load probabilities</h3>
<p>Now let‚Äôs load the probabilities files.</p>
<ul>
<li>Click on the folder icon of the <code>Tissue Cartography</code> &gt; <code>Segmentation File Path</code>, navigate to the working directory, and select the file <code>Drosophila_CAAX-mCherry_Probabilities.tiff</code>.</li>
<li>Click <code>Accept</code>.</li>
</ul>
<p><a href="media/36-blender-probabilities.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="media/36-blender-probabilities.png" class="img-fluid"></a></p>
<p>The file name will appear in the field, but before loading we want to adjust one parameter. Blender will take the segmentation probabilities and convert it into a tridimensional mesh. Generally, the raw segmentation is full of sharp angles, which will not look very nice when we map the image information onto the mesh for visualization. Therefore, it is generally a good idea to apply a degree of smoothing upon importing the segmentation.</p>
<p>We can control the smoothing in the small field below and to the right of <code>Segmentation File Path</code> named <code>S... 0.00</code>. It should read <code>Smoothing (¬µm)</code> but the panel is too narrow to show the full name.</p>
<ul>
<li>Click on it and set it to <code>1.0</code>.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/37-smoothing-zero.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="media/37-smoothing-zero.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/38-smoothing-one.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="media/38-smoothing-one.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>Now click on <code>Get mesh(es) from binary segmentation .tiff file(s)</code> to generate the mesh (it takes a second).</li>
</ul>
<p><a href="media/39-blender-mesh.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="media/39-blender-mesh.png" class="img-fluid"></a></p>
<p>A gray mesh shaped like our sample will appear inside the bounding box in the main window. Also notice that a new row appeared at the top right panel under <code>Scene Collection</code> &gt; <code>Collection</code> named <code>Drosophila_CAAX-mCherry_Probabilities_c0</code>.</p>
<p>Congratulations! We have successfully generated a 3D mesh of the sample. That‚Äôs already a powerful visualization method. Celebrate by exploring the sample. Rotate all around, zoom in to see details, and check how good the mesh is. Are there any holes or other artifacts?</p>
</section>
<section id="apply-shading" class="level3">
<h3 class="anchored" data-anchor-id="apply-shading">Apply shading</h3>
<p>The mesh is nice, but it would be even better to see the actual image data overlaid on the mesh. We can accomplish that using the shading view and function of Blender.</p>
<ul>
<li>First, we need to activate the Shading workspace at the top right corner of the main window (an icon that looks like a pie chart).</li>
</ul>
<p><a href="media/40-shading-viewport.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="media/40-shading-viewport.png" class="img-fluid"></a></p>
<p>Once clicked, the mesh will become almost white.</p>
<p><a href="media/41-shading-blank.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="media/41-shading-blank.png" class="img-fluid"></a></p>
<p>Before applying the shading, there‚Äôs one important parameter to set: <code>Vertex ... 0.00</code> or, in full, <code>Vertex Shader Normal Offset (¬µm)</code>.</p>
<p><a href="media/42-offset-zero.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="media/42-offset-zero.png" class="img-fluid"></a></p>
<p>When this parameter is <code>0</code>, the image data that corresponds to the limits of the segmentation is applied onto the mesh. In this case, this is the surface of the sample which, in this case, does not have much information. The fluorescent signal of the tissue, in this case, is a few microns deeper. Therefore, we can use the offset parameter to adjust the exact layer to be applied to the mesh as shading.</p>
<ul>
<li>In this case, a value of <code>5</code> works well.</li>
</ul>
<p><a href="media/43-offset-five.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="media/43-offset-five.png" class="img-fluid"></a></p>
<p>Every time we want to apply or refresh the shading, we need to select the bounding box and probabilities entries in the <code>Scene Collection</code> &gt; <code>Collection</code> top right panel.</p>
<ul>
<li>We can do so by clicking on one and <code>Ctrl+Click</code> on the other to select both.</li>
</ul>
<p><a href="media/44-shading-boxprob.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="media/44-shading-boxprob.png" class="img-fluid"></a></p>
<ul>
<li>Finally, press <code>Initialize/refresh vertex shading</code> to apply the shading and wait‚Ä¶</li>
</ul>
<p><a href="media/45-shading-applied.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="media/45-shading-applied.png" class="img-fluid"></a></p>
<p>After a few seconds, we should see cell membranes overlaid onto the mesh.</p>
<ul>
<li>Take the chance to explore the sample again, now with some biological information projected into 3D!</li>
</ul>
</section>
</section>
<section id="sec-generate-projection" class="level2">
<h2 class="anchored" data-anchor-id="sec-generate-projection">Generate projection</h2>
<p>We are ready to generate our first cartographic projection. This is done in the <code>UV Editing</code> workspace.</p>
<ul>
<li>Click on the <code>UV Editing</code> tab to activate it.</li>
</ul>
<p><a href="media/46-uv-workspace.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="media/46-uv-workspace.png" class="img-fluid"></a></p>
<p>The workspace will be divided in two. On the left we will see the projected mesh and on the right it is the mesh of the original sample in 3D.</p>
<section id="sec-setup-uv" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-uv">Set up UV Editing</h3>
<p>Before starting, we need to make sure that the correct options are enabled.</p>
<ul>
<li>First, zoom out the right side window for the entire sample to be visible.</li>
</ul>
<p><a href="media/47-uv-sample.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="media/47-uv-sample.png" class="img-fluid"></a></p>
<ul>
<li>Then, disable the bounding box entry in the top right panel under <code>Scene Collection</code> &gt; <code>Collection</code> by <code>Ctrl+Click</code> on the square nodes symbol on the left of the bounding box entry as shown below.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/48-uv-collection.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="media/48-uv-collection.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/49-uv-disable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="media/49-uv-disable.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>Next, change the <code>Select Mode</code> from <code>Vertex</code> to <code>Face</code>.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/50-uv-vertex.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="media/50-uv-vertex.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/51-uv-face.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="media/51-uv-face.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>In the right hand workspace, we should see the sample (not the bounding box) highlighted in light orange.</p>
<p><a href="media/52-uv-ready.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="media/52-uv-ready.png" class="img-fluid"></a></p>
<p>We might accidentally click somewhere and the mesh will become black.</p>
<p><a href="media/53-uv-all.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="media/53-uv-all.png" class="img-fluid"></a></p>
<p>If this happens, worry not!</p>
<ul>
<li>Simply press <code>A</code> or click on <code>Select</code> &gt; <code>All</code> to select all the mesh.</li>
</ul>
<p>To finish the setup, we need to orient the sample properly for the projection, it matters!</p>
<ul>
<li>Click on the Y axis handle until the sample is oriented vertically with the narrower tip pointing upward.</li>
</ul>
<p><a href="media/54-uv-orient.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="media/54-uv-orient.png" class="img-fluid"></a></p>
<p>We are ready to project the mesh.</p>
</section>
<section id="sec-project-mesh" class="level3">
<h3 class="anchored" data-anchor-id="sec-project-mesh">Project mesh</h3>
<p>While the right side shows the sample, the left side shows how the projected mesh looks like; it is initially empty.</p>
<ul>
<li>To make the first projection, go to <code>UV</code> &gt; <code>Cylinder Projection</code> to project the mesh over the curved wall of a cylinder.</li>
</ul>
<p><a href="media/55-uv-cylinder.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="media/55-uv-cylinder.png" class="img-fluid"></a></p>
<p>A crazy, palisade-like wall will appear.</p>
<p><a href="media/56-uv-palisade.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="media/56-uv-palisade.png" class="img-fluid"></a></p>
<p>But don‚Äôt despair.</p>
<ul>
<li>Click on the tiny menu named <code>Cylinder Projection</code> that appeared at the bottom of the workspace.</li>
</ul>
<p>The options for the cylinder projection will appear. There we can define the orientation of the axes and other options to change how the 3D mesh is transformed into a 2D surface. What we need for now is to contain the projection into the squared bounding area.</p>
<ul>
<li>Activate the checkbox <code>Scale to Bounds</code>.</li>
</ul>
<p><a href="media/57-uv-scale.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="media/57-uv-scale.png" class="img-fluid"></a></p>
<p>This will nicely limit the mesh to the projection area.</p>
<p>That‚Äôs it. We have our first projected mesh. How good is it? Ideally, the mesh should occupy the entire projection area. Our projected mesh has a couple of portions slightly bulging outside the area, and we have an empty vertical portion on the right side. This could be fixed with some editing. However, for now, it looks good enough for a first try.</p>
</section>
<section id="sec-project-data" class="level3">
<h3 class="anchored" data-anchor-id="sec-project-data">Project data</h3>
<p>The next step is to project the actual image data onto this projected mesh surface.</p>
<ul>
<li>Change back to the <code>Layout</code> workspace, select both <code>Drosophila_CAAX-mCherry_BoundingBox</code> and <code>Drosophila_CAAX-mCherry_Probabilities_c0</code> under <code>Scene Collection</code> &gt; <code>Collection</code>, and change the option <code>Normal Offs...</code> (<code>Normal Offsets (¬µm)</code>) to <code>5</code> to match the <code>Vertex Shader Normal Offset (¬µm)</code> option.</li>
</ul>
<p>Note: <code>Normal Offsets (¬µm)</code> accepts a comma-separated list of values. We can put <code>0,1,2,3,4,5</code> to generate a projection with 6 slices representing onion layers deeper into the tissues.</p>
<ul>
<li>Then, click on <code>Create Projection</code>.</li>
</ul>
<p><a href="media/58-create-projection.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="media/58-create-projection.png" class="img-fluid"></a></p>
<p>Wait‚Ä¶ the interface might become unresponsive. If a dialog appears, click on <code>Wait</code> and wait. When done, the shading over the sample will blink. But, it should look very similar to how it was before (and if it doesn‚Äôt, it is a sign that something went wrong).</p>
</section>
<section id="sec-check-projection" class="level3">
<h3 class="anchored" data-anchor-id="sec-check-projection">Check projection</h3>
<ul>
<li>To visually inspect the projected data, change back to the <code>UV Editing</code> workspace.</li>
</ul>
<p><a href="media/59-uv-after.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="media/59-uv-after.png" class="img-fluid"></a></p>
<ul>
<li>Zoom out on the left side window to see the entire projection.</li>
<li>Then click anywhere outside the sample or projection to unselect the mesh.</li>
</ul>
<p><a href="media/60-uv-projected.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="media/60-uv-projected.png" class="img-fluid"></a></p>
<p>The sample mesh will become visible in black, and the cartographic projection should appear on the left side window. The orientation of the sample will match that of the projection (if the sample is upside down when projecting the mesh, the projected mesh will also be upside down).</p>
<p>So, what happened here? We projected the sample mesh to 2D using the cylinder approach. Then the add-on Blender Tissue Cartography used this projected mesh to create a projection of the image data from the original stack. Quite nice!</p>
<p>Every time we create a new projection, the projected data is stored as an image which is available for Blender to display as an image ‚Äúdata-block‚Äù. We can see them by clicking on the picture icon in the top menu.</p>
<p><a href="media/61-uv-datablock.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="media/61-uv-datablock.png" class="img-fluid"></a></p>
<p>This first projection is named <code>Channel_0_Layer_0</code>. The next will be named <code>Channel_0_Layer_0.001</code>, <code>Channel_0_Layer_0.002</code>, and so on.</p>
</section>
<section id="sec-save-projection" class="level3">
<h3 class="anchored" data-anchor-id="sec-save-projection">Save projection</h3>
<p>The projection now exists in Blender, but we need to export it to file.</p>
<ul>
<li>For that, go back to the <code>Layout</code> workspace, select both <code>Drosophila_CAAX-mCherry_BoundingBox</code> and <code>Drosophila_CAAX-mCherry_Probabilities_c0</code> under <code>Scene Collection</code> &gt; <code>Collection</code> again, then click on <code>Save Projection</code>.</li>
</ul>
<p><a href="media/62-save-projection.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="media/62-save-projection.png" class="img-fluid"></a></p>
<p>A <code>Blender File View</code> window will open.</p>
<ul>
<li>Navigate to the working directory.</li>
<li>In the file name field put the name of the file with <code>_cylinder</code> appended to it, to read <code>Drosophila_CAAX-mCherry_cylinder.tif</code>.</li>
<li>Then press <code>Save Projection</code>.</li>
</ul>
<p>Three new files will appear in the working directory with <code>BakedData</code>, <code>BakedNormals</code>, and <code>BakedPositions</code> suffixes appended to the dataset filename.</p>
<p><a href="media/63-projection-saved.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63"><img src="media/63-projection-saved.png" class="img-fluid"></a></p>
<ul>
<li><code>BakedData</code> shows the original image data projected on the surface.</li>
<li><code>BakedPositions</code> shows the original XYZ positions projected on the surface in RGB.</li>
<li><code>BakedNormals</code> shows the XYZ surface directions perpendicular to each point in RGB.</li>
</ul>
</section>
<section id="sec-open-projection" class="level3">
<h3 class="anchored" data-anchor-id="sec-open-projection">Open projection</h3>
<p>Let‚Äôs open the files in Fiji for inspection.</p>
<ul>
<li>Drag and drop the files into Fiji.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/64-baked-data.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="media/64-baked-data.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/65-baked-normals.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="media/65-baked-normals.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/66-baked-positions.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="media/66-baked-positions.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>Explore them in more detail, check with <code>Image</code> &gt; <code>Color</code> &gt; <code>Channels Tool...</code> (<code>Ctrl+Shift+Z</code>) how the individual channels look like. These files provide important information to reconstruct back the 3D information from the projected surface in downstream analyses.</p>
</section>
</section>
<section id="sec-optimize-projection" class="level2">
<h2 class="anchored" data-anchor-id="sec-optimize-projection">Optimize projection</h2>
<p>Our initial projection is satisfactory, but there are many ways to optimize it to our specific needs. One immediate thing is to try a <code>Sphere Projection</code> instead of <code>Cylinder Projection</code>. They are quite similar, but I found the sphere projection to be more consistent and predictable and might work better for more spherical samples.</p>
<p>Another common use case is to be able to determine where the mesh will unwrap. This might be important for downstream analyses. In our sample, for example, the projection put the dorsal side on the left side (where a clump of germ cells are visible at the bottom) and the ventral side on the right side. However, let‚Äôs say that I need for my analyses the dorsal side at the center of the projection.</p>
<p>To accomplish that we can manually mark a seam on our mesh to define the unwrapping position.</p>
<section id="sec-mark-seam" class="level3">
<h3 class="anchored" data-anchor-id="sec-mark-seam">Mark seam on mesh</h3>
<ul>
<li>Go to the <code>UV Editing</code> workspace and change the <code>Select Mode</code> to <code>Edge select</code>.</li>
</ul>
<p><a href="media/67-seam-edge.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="media/67-seam-edge.png" class="img-fluid"></a></p>
<p>In this mode, when we click on the mesh an edge is selected and when we subsequently <code>Ctrl+Click</code> on another edge, the shortest path between the two edges will be selected. Like this we can quickly select a line along the sample to mark the unwrapping position. What we want is to trace a line through the ventral side of the sample. This is the region opposite to the germ cell clump.</p>
<ul>
<li>Using the handle buttons, reorient the sample sideways with the ventral side facing us.</li>
</ul>
<p><a href="media/68-seam-zoom.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68"><img src="media/68-seam-zoom.png" class="img-fluid"></a></p>
<p>We will start by selecting an edge on one of the poles.</p>
<ul>
<li>Turn the sample to show one of the poles and zoom in to see the edges clearly.</li>
<li>Then click on one edge at the center of the pole to select it.</li>
</ul>
<p><a href="media/69-seam-first.png" class="lightbox" data-gallery="quarto-lightbox-gallery-69"><img src="media/69-seam-first.png" class="img-fluid"></a></p>
<ul>
<li>Zoom out slightly, turn the sample, and <code>Ctrl+Click</code> on another edge further away from the pole.</li>
<li>A yellow line will appear connecting the pole with the current edge.</li>
</ul>
<p><a href="media/70-seam-second.png" class="lightbox" data-gallery="quarto-lightbox-gallery-70"><img src="media/70-seam-second.png" class="img-fluid"></a></p>
<ul>
<li>Continue <code>Ctrl+Click</code> on edges along the sample until the opposite pole (don‚Äôt worry if the line isn‚Äôt perfectly straight).</li>
</ul>
<div class="quarto-layout-panel" data-layout-nrow="2" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/71-seam-third.png" class="lightbox" data-gallery="quarto-lightbox-gallery-71"><img src="media/71-seam-third.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/72-seam-fourth.png" class="lightbox" data-gallery="quarto-lightbox-gallery-72"><img src="media/72-seam-fourth.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/73-seam-fifth.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="media/73-seam-fifth.png" class="img-fluid"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/74-seam-sixth.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74"><img src="media/74-seam-sixth.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/75-seam-seventh.png" class="lightbox" data-gallery="quarto-lightbox-gallery-75"><img src="media/75-seam-seventh.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/76-seam-eighth.png" class="lightbox" data-gallery="quarto-lightbox-gallery-76"><img src="media/76-seam-eighth.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<ul>
<li>Now press <code>Ctrl+E</code> to open a menu with edge options and select <code>Mark Seam</code>.</li>
</ul>
<p><a href="media/77-seam-mark.png" class="lightbox" data-gallery="quarto-lightbox-gallery-77"><img src="media/77-seam-mark.png" class="img-fluid"></a></p>
<p>The seam will be marked in red (below it‚Äôs mixed with yellow line from the edge selection).</p>
<p><a href="media/78-seam-done.png" class="lightbox" data-gallery="quarto-lightbox-gallery-78"><img src="media/78-seam-done.png" class="img-fluid"></a></p>
</section>
<section id="sec-project-mesh-seam" class="level3">
<h3 class="anchored" data-anchor-id="sec-project-mesh-seam">Project mesh with seam</h3>
<ul>
<li>Now reorient the sample vertically again with the narrow tip up and change the <code>Select Mode</code> back to <code>Face select</code>.</li>
</ul>
<p><a href="media/79-seam-orient.png" class="lightbox" data-gallery="quarto-lightbox-gallery-79"><img src="media/79-seam-orient.png" class="img-fluid"></a></p>
<ul>
<li>Press <code>A</code> to select all the mesh (they will turn orange).</li>
<li>Go to <code>UV</code> &gt; <code>Cylinder Projection</code>.</li>
<li>Then check <code>Preserve Seams</code> in the option box.</li>
</ul>
<p><a href="media/80-seam-preserve.png" class="lightbox" data-gallery="quarto-lightbox-gallery-80"><img src="media/80-seam-preserve.png" class="img-fluid"></a></p>
<p>As we can see, the projection changed. It is squeezed at the center of the projection area due to the very long protruding mesh at the top left and bottom right regions. Let‚Äôs evaluate how good it is by projecting the data.</p>
</section>
<section id="sec-project-data-seam" class="level3">
<h3 class="anchored" data-anchor-id="sec-project-data-seam">Project data with seam</h3>
<ul>
<li>Go to the <code>Layout</code> workspace, select both the bounding box and probabilities under <code>Scene Collection</code>, and press <code>Create Projection</code>; then, wait‚Ä¶</li>
</ul>
<p><a href="media/81-projection-seam.png" class="lightbox" data-gallery="quarto-lightbox-gallery-81"><img src="media/81-projection-seam.png" class="img-fluid"></a></p>
<ul>
<li>When done, go back to the <code>UV Editing</code> workspace and click anywhere outside the sample to unselect the mesh.</li>
</ul>
<p>The new data projection should be visible on the left side.</p>
<ul>
<li>If not, click on the image data-block picture icon and select <code>Channel_0_Layer_0.001</code>.</li>
</ul>
<p><a href="media/82-projection-squeezed.png" class="lightbox" data-gallery="quarto-lightbox-gallery-82"><img src="media/82-projection-squeezed.png" class="img-fluid"></a></p>
<p>We have successfully changed the position of the unwrapping using the seam. The clump of germ cells is now at the center of the projection.</p>
<p>This projection is OK, but the contents are squeezed and it is not occupying the full bounding area. We can improve this by editing the projection mesh.</p>
</section>
<section id="sec-edit-projected-mesh" class="level3">
<h3 class="anchored" data-anchor-id="sec-edit-projected-mesh">Edit projected mesh</h3>
<ul>
<li>Press <code>A</code> to select the entire mesh.</li>
<li>Select the tool <code>Transform</code> on the left side menu.</li>
</ul>
<p><a href="media/83-projection-transform.png" class="lightbox" data-gallery="quarto-lightbox-gallery-83"><img src="media/83-projection-transform.png" class="img-fluid"></a></p>
<ul>
<li>Hover the mouse on the right side edge to reveal the scale handle.</li>
</ul>
<p><a href="media/84-projection-scale.png" class="lightbox" data-gallery="quarto-lightbox-gallery-84"><img src="media/84-projection-scale.png" class="img-fluid"></a></p>
<ul>
<li>Drag the right side to the right to extend the orange mesh until the edge of the projection area.</li>
<li>Then, drag the other side to extend the mesh to the left side.</li>
<li>Finally, make adjustments so that the projected mesh is covering most of the projection area as shown below.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/85-projection-right.png" class="lightbox" data-gallery="quarto-lightbox-gallery-85"><img src="media/85-projection-right.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><a href="media/86-projection-scaled.png" class="lightbox" data-gallery="quarto-lightbox-gallery-86"><img src="media/86-projection-scaled.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>Now we can use the <code>Pinch</code> or <code>Grab</code> tools to edit the mesh at the corners, so that they are not clipped out. Or, we can leave them as is (they will be clipped out of the projection).</p>
<ul>
<li>Use <code>Pinch</code> to drag finer portions of the mesh to the corners.</li>
<li>Use <code>Grab</code> to drag larger portions of the mesh to the corners.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/87-projection-pinch.png" class="lightbox" data-gallery="quarto-lightbox-gallery-87"><img src="media/87-projection-pinch.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/88-projection-grab.png" class="lightbox" data-gallery="quarto-lightbox-gallery-88"><img src="media/88-projection-grab.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/89-projection-edited.png" class="lightbox" data-gallery="quarto-lightbox-gallery-89"><img src="media/89-projection-edited.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>At the end, the mesh should be filling more or less the projection area.</p>
</section>
<section id="sec-check-edited-mesh" class="level3">
<h3 class="anchored" data-anchor-id="sec-check-edited-mesh">Check edited projection</h3>
<p>To check the new projection with the edited mesh, we need to re-create the image data projection onto the edited mesh.</p>
<ul>
<li>Go to the <code>Layout</code> workspace, select both the bounding box and probabilities under <code>Scene Collection</code>, and press <code>Create Projection</code>; then, wait‚Ä¶</li>
<li>When done, switch to the <code>UV Editing</code> workspace and deselect the mesh and check the new projection (select the latest image data-block, likely <code>Channel_0_Layer_0.002</code>).</li>
</ul>
<p><a href="media/90-check-edited.png" class="lightbox" data-gallery="quarto-lightbox-gallery-90"><img src="media/90-check-edited.png" class="img-fluid"></a></p>
<p>Despite the unevenness of the corners (next time we can improve our pinching and grabbing skills), the edited projection is better than the first one and the tissue is oriented the way we needed. Let‚Äôs save the projection to disk.</p>
<ul>
<li>Go to the <code>Layout</code> workspace, select both the bounding box and probabilities entries under <code>Scene Collection</code> &gt; <code>Collection</code>, and click on <code>Save Projection</code>.</li>
<li>Then navigate to the working directory and give the file a different suffix.</li>
</ul>
<p><a href="media/91-save-edited.png" class="lightbox" data-gallery="quarto-lightbox-gallery-91"><img src="media/91-save-edited.png" class="img-fluid"></a></p>
<ul>
<li>Finally, open the newly generated files in Fiji to investigate.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/92-baked-data.png" class="lightbox" data-gallery="quarto-lightbox-gallery-92"><img src="media/92-baked-data.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/93-baked-normals.png" class="lightbox" data-gallery="quarto-lightbox-gallery-93"><img src="media/93-baked-normals.png" class="img-fluid"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="media/94-baked-positions.png" class="lightbox" data-gallery="quarto-lightbox-gallery-94"><img src="media/94-baked-positions.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>The projection is ready for image analyses.</p>
<p>There are several other use cases that are not covered in the current version of this tutorial. For example, how can we generate a projection with more layers, or create and register projections for different timepoints. But, if you are interested, these use cases are described in the <a href="https://nikolas-claussen.github.io/blender-tissue-cartography/">Blender Tissue Cartography</a> paper and documentation <span class="citation" data-cites="Claussen2025-pv">(<a href="#ref-Claussen2025-pv" role="doc-biblioref">Claussen et al. 2025</a>)</span>.</p>
</section>
</section>
<section id="sec-citation" class="level2">
<h2 class="anchored" data-anchor-id="sec-citation">Citation</h2>
<p>Vellutini, B. C. (2026). Tissue cartography using Blender. Zenodo. <a href="https://doi.org/10.5281/zenodo.18090965" class="uri">https://doi.org/10.5281/zenodo.18090965</a></p>
</section>
<section id="sec-license" class="level2">
<h2 class="anchored" data-anchor-id="sec-license">License</h2>
<p>This tutorial is available under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</section>
<section id="sec-references" class="level2">
<h2 class="anchored" data-anchor-id="sec-references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Berg2019-ab" class="csl-entry" role="listitem">
Berg, Stuart, Dominik Kutra, Thorben Kroeger, Christoph N Straehle, Bernhard X Kausler, Carsten Haubold, Martin Schiegg, et al. 2019. <span>‚Äú<span class="nocase">i</span>lastik: Interactive Machine Learning for (Bio)image Analysis.‚Äù</span> <em>Nat. Methods</em>, September. <a href="https://doi.org/10.1038/s41592-019-0582-9">https://doi.org/10.1038/s41592-019-0582-9</a>.
</div>
<div id="ref-Blender-Foundation2002-jm" class="csl-entry" role="listitem">
Blender Foundation. 2002. <span>‚ÄúBlender - the Free and Open Source 3D Creation Software.‚Äù</span> Computer software. <a href="https://www.blender.org/">https://www.blender.org/</a>.
</div>
<div id="ref-Claussen2025-pv" class="csl-entry" role="listitem">
Claussen, Nikolas, C√©cile Regis, Susan Wopat, and Sebastian Streichan. 2025. <span>‚ÄúBlender Tissue Cartography: An Intuitive Tool for the Analysis of Dynamic 3D Microscopy Data.‚Äù</span> <em>bioRxiv</em>, July, 2025.02.04.636523. <a href="https://doi.org/10.1101/2025.02.04.636523">https://doi.org/10.1101/2025.02.04.636523</a>.
</div>
<div id="ref-Heemskerk2015-kv" class="csl-entry" role="listitem">
Heemskerk, Idse, and Sebastian J Streichan. 2015. <span>‚ÄúTissue Cartography: Compressing Bio-Image Data by Dimensional Reduction.‚Äù</span> <em>Nat. Methods</em> 12 (December): 1139‚Äì42. <a href="https://doi.org/10.1038/nmeth.3648">https://doi.org/10.1038/nmeth.3648</a>.
</div>
<div id="ref-Schindelin2012-di" class="csl-entry" role="listitem">
Schindelin, Johannes, Ignacio Arganda-Carreras, Erwin Frise, Verena Kaynig, Mark Longair, Tobias Pietzsch, Stephan Preibisch, et al. 2012. <span>‚ÄúFiji: An Open-Source Platform for Biological-Image Analysis.‚Äù</span> <em>Nat. Methods</em> 9 (June): 676‚Äì82. <a href="https://doi.org/10.1038/nmeth.2019">https://doi.org/10.1038/nmeth.2019</a>.
</div>
<div id="ref-Vellutini2022-ya" class="csl-entry" role="listitem">
Vellutini, Bruno C. 2022. <em>How to Make Cartographic Projections Using <span>ImSAnE</span></em>. Zenodo. <a href="https://doi.org/10.5281/zenodo.7628299">https://doi.org/10.5281/zenodo.7628299</a>.
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bruvellu\.github\.io\/light-sheet-image-analysis-workshop-2026");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../practicals/practical_3d/index.html" class="pagination-link" aria-label="Visualization of 3D data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Visualization of 3D data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../practicals/practical_deep_learning_segmentation/index.html" class="pagination-link" aria-label="3D Deep Learning Segmentation">
        <span class="nav-page-text">3D Deep Learning Segmentation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://lightsheetchile.cl/light-sheet-image-analysis-workshop-2026-2/">
<p>LiSIUM</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/edit/main/practicals/practical_cartography/index.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bruvellu/light-sheet-image-analysis-workshop-2026/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>